2025-10-13 09:40:26,054 [trainer.py] => config: exps/sema_ina.json
2025-10-13 09:40:26,054 [trainer.py] => eval: False
2025-10-13 09:40:26,055 [trainer.py] => prefix: reproduce
2025-10-13 09:40:26,055 [trainer.py] => dataset: imageneta
2025-10-13 09:40:26,055 [trainer.py] => memory_size: 0
2025-10-13 09:40:26,055 [trainer.py] => memory_per_class: 0
2025-10-13 09:40:26,056 [trainer.py] => fixed_memory: False
2025-10-13 09:40:26,056 [trainer.py] => shuffle: False
2025-10-13 09:40:26,056 [trainer.py] => init_cls: 10
2025-10-13 09:40:26,056 [trainer.py] => increment: 10
2025-10-13 09:40:26,056 [trainer.py] => model_name: sema
2025-10-13 09:40:26,056 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-10-13 09:40:26,057 [trainer.py] => device: [device(type='cuda', index=0)]
2025-10-13 09:40:26,057 [trainer.py] => seed: 1993
2025-10-13 09:40:26,057 [trainer.py] => batch_size: 32
2025-10-13 09:40:26,058 [trainer.py] => weight_decay: 0.0005
2025-10-13 09:40:26,058 [trainer.py] => min_lr: 0
2025-10-13 09:40:26,058 [trainer.py] => ffn_adapter_type: adaptmlp
2025-10-13 09:40:26,058 [trainer.py] => ffn_num: 16
2025-10-13 09:40:26,058 [trainer.py] => optimizer: sgd
2025-10-13 09:40:26,058 [trainer.py] => vpt_type: shallow
2025-10-13 09:40:26,059 [trainer.py] => prompt_token_num: 5
2025-10-13 09:40:26,059 [trainer.py] => func_epoch: 20
2025-10-13 09:40:26,059 [trainer.py] => rd_epoch: 20
2025-10-13 09:40:26,059 [trainer.py] => init_lr: 0.005
2025-10-13 09:40:26,059 [trainer.py] => rd_lr: 0.01
2025-10-13 09:40:26,060 [trainer.py] => rd_dim: 128
2025-10-13 09:40:26,060 [trainer.py] => buffer_size: 500
2025-10-13 09:40:26,060 [trainer.py] => detect_batch_size: 128
2025-10-13 09:40:26,060 [trainer.py] => exp_threshold: 1
2025-10-13 09:40:26,060 [trainer.py] => adapt_start_layer: 9
2025-10-13 09:40:26,060 [trainer.py] => adapt_end_layer: 11
2025-10-13 09:49:52,320 [trainer.py] => config: exps/sema_ina.json
2025-10-13 09:49:52,320 [trainer.py] => eval: False
2025-10-13 09:49:52,320 [trainer.py] => prefix: reproduce
2025-10-13 09:49:52,320 [trainer.py] => dataset: imageneta
2025-10-13 09:49:52,320 [trainer.py] => memory_size: 0
2025-10-13 09:49:52,321 [trainer.py] => memory_per_class: 0
2025-10-13 09:49:52,321 [trainer.py] => fixed_memory: False
2025-10-13 09:49:52,321 [trainer.py] => shuffle: False
2025-10-13 09:49:52,321 [trainer.py] => init_cls: 10
2025-10-13 09:49:52,321 [trainer.py] => increment: 10
2025-10-13 09:49:52,321 [trainer.py] => model_name: sema
2025-10-13 09:49:52,321 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-10-13 09:49:52,321 [trainer.py] => device: [device(type='cuda', index=0)]
2025-10-13 09:49:52,321 [trainer.py] => seed: 1993
2025-10-13 09:49:52,322 [trainer.py] => batch_size: 32
2025-10-13 09:49:52,322 [trainer.py] => weight_decay: 0.0005
2025-10-13 09:49:52,322 [trainer.py] => min_lr: 0
2025-10-13 09:49:52,322 [trainer.py] => ffn_adapter_type: adaptmlp
2025-10-13 09:49:52,322 [trainer.py] => ffn_num: 16
2025-10-13 09:49:52,322 [trainer.py] => optimizer: sgd
2025-10-13 09:49:52,322 [trainer.py] => vpt_type: shallow
2025-10-13 09:49:52,322 [trainer.py] => prompt_token_num: 5
2025-10-13 09:49:52,322 [trainer.py] => func_epoch: 20
2025-10-13 09:49:52,323 [trainer.py] => rd_epoch: 20
2025-10-13 09:49:52,323 [trainer.py] => init_lr: 0.005
2025-10-13 09:49:52,323 [trainer.py] => rd_lr: 0.01
2025-10-13 09:49:52,323 [trainer.py] => rd_dim: 128
2025-10-13 09:49:52,323 [trainer.py] => buffer_size: 500
2025-10-13 09:49:52,323 [trainer.py] => detect_batch_size: 128
2025-10-13 09:49:52,323 [trainer.py] => exp_threshold: 1
2025-10-13 09:49:52,323 [trainer.py] => adapt_start_layer: 9
2025-10-13 09:49:52,324 [trainer.py] => adapt_end_layer: 11
2025-10-13 09:54:03,041 [trainer.py] => config: exps/sema_ina.json
2025-10-13 09:54:03,043 [trainer.py] => eval: False
2025-10-13 09:54:03,043 [trainer.py] => prefix: reproduce
2025-10-13 09:54:03,043 [trainer.py] => dataset: imageneta
2025-10-13 09:54:03,043 [trainer.py] => memory_size: 0
2025-10-13 09:54:03,043 [trainer.py] => memory_per_class: 0
2025-10-13 09:54:03,043 [trainer.py] => fixed_memory: False
2025-10-13 09:54:03,044 [trainer.py] => shuffle: False
2025-10-13 09:54:03,044 [trainer.py] => init_cls: 10
2025-10-13 09:54:03,044 [trainer.py] => increment: 10
2025-10-13 09:54:03,044 [trainer.py] => model_name: sema
2025-10-13 09:54:03,044 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-10-13 09:54:03,044 [trainer.py] => device: [device(type='cuda', index=0)]
2025-10-13 09:54:03,045 [trainer.py] => seed: 1993
2025-10-13 09:54:03,045 [trainer.py] => batch_size: 32
2025-10-13 09:54:03,045 [trainer.py] => weight_decay: 0.0005
2025-10-13 09:54:03,045 [trainer.py] => min_lr: 0
2025-10-13 09:54:03,045 [trainer.py] => ffn_adapter_type: adaptmlp
2025-10-13 09:54:03,045 [trainer.py] => ffn_num: 16
2025-10-13 09:54:03,045 [trainer.py] => optimizer: sgd
2025-10-13 09:54:03,045 [trainer.py] => vpt_type: shallow
2025-10-13 09:54:03,046 [trainer.py] => prompt_token_num: 5
2025-10-13 09:54:03,046 [trainer.py] => func_epoch: 20
2025-10-13 09:54:03,046 [trainer.py] => rd_epoch: 20
2025-10-13 09:54:03,046 [trainer.py] => init_lr: 0.005
2025-10-13 09:54:03,046 [trainer.py] => rd_lr: 0.01
2025-10-13 09:54:03,046 [trainer.py] => rd_dim: 128
2025-10-13 09:54:03,046 [trainer.py] => buffer_size: 500
2025-10-13 09:54:03,047 [trainer.py] => detect_batch_size: 128
2025-10-13 09:54:03,047 [trainer.py] => exp_threshold: 1
2025-10-13 09:54:03,047 [trainer.py] => adapt_start_layer: 9
2025-10-13 09:54:03,047 [trainer.py] => adapt_end_layer: 11
2025-10-13 09:54:03,060 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-10-13 09:54:04,410 [sema_block.py] => Adapter 0.0 added at block 0
2025-10-13 09:54:04,441 [sema_block.py] => Adapter 1.0 added at block 1
2025-10-13 09:54:04,471 [sema_block.py] => Adapter 2.0 added at block 2
2025-10-13 09:54:04,501 [sema_block.py] => Adapter 3.0 added at block 3
2025-10-13 09:54:04,533 [sema_block.py] => Adapter 4.0 added at block 4
2025-10-13 09:54:04,563 [sema_block.py] => Adapter 5.0 added at block 5
2025-10-13 09:54:04,591 [sema_block.py] => Adapter 6.0 added at block 6
2025-10-13 09:54:04,623 [sema_block.py] => Adapter 7.0 added at block 7
2025-10-13 09:54:04,655 [sema_block.py] => Adapter 8.0 added at block 8
2025-10-13 09:54:04,685 [sema_block.py] => Adapter 9.0 added at block 9
2025-10-13 09:54:04,720 [sema_block.py] => Adapter 10.0 added at block 10
2025-10-13 09:54:04,754 [sema_block.py] => Adapter 11.0 added at block 11
2025-10-13 09:54:05,357 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-10-13 09:54:06,750 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-10-13 09:54:06,958 [trainer.py] => All params: 86704716
2025-10-13 09:54:06,959 [trainer.py] => Trainable params: 906060
2025-10-13 09:54:06,961 [sema.py] => Learning on 0-10
2025-10-13 09:57:48,047 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.252, Train_accy 91.97, Test_accy 89.74
2025-10-13 10:01:47,405 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.257, Train_accy 91.52, Test_accy 89.74
2025-10-13 10:01:50,620 [trainer.py] => No NME accuracy.
2025-10-13 10:01:50,620 [trainer.py] => CNN: {'total': 89.74, '00-09': 89.74, 'old': 0, 'new': 89.74}
2025-10-13 10:01:50,621 [trainer.py] => CNN top1 curve: [89.74]
2025-10-13 10:01:50,621 [trainer.py] => CNN top5 curve: [99.36]

2025-10-13 10:01:50,621 [trainer.py] => Average Accuracy (CNN): 89.74 

2025-10-13 10:01:50,622 [trainer.py] => All params: 86858516
2025-10-13 10:01:50,623 [trainer.py] => Trainable params: 153800
2025-10-13 10:01:50,623 [sema.py] => Learning on 10-20
2025-10-13 10:36:32,678 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.214, Train_accy 93.49, Test_accy 84.69
2025-10-13 10:36:46,881 [trainer.py] => No NME accuracy.
2025-10-13 10:36:46,882 [trainer.py] => CNN: {'total': 84.69, '00-09': 85.9, '10-19': 83.44, 'old': 85.9, 'new': 83.44}
2025-10-13 10:36:46,882 [trainer.py] => CNN top1 curve: [89.74, 84.69]
2025-10-13 10:36:46,882 [trainer.py] => CNN top5 curve: [99.36, 98.7]

2025-10-13 10:36:46,883 [trainer.py] => Average Accuracy (CNN): 87.215 

2025-10-13 10:36:46,883 [trainer.py] => All params: 86858516
2025-10-13 10:36:46,884 [trainer.py] => Trainable params: 153800
2025-10-13 10:36:46,884 [sema.py] => Learning on 20-30
2025-10-13 10:51:51,861 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.161, Train_accy 94.34, Test_accy 81.66
2025-10-13 10:52:08,219 [trainer.py] => No NME accuracy.
2025-10-13 10:52:08,220 [trainer.py] => CNN: {'total': 81.66, '00-09': 78.21, '10-19': 79.47, '20-29': 87.04, 'old': 78.83, 'new': 87.04}
2025-10-13 10:52:08,220 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66]
2025-10-13 10:52:08,220 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08]

2025-10-13 10:52:08,221 [trainer.py] => Average Accuracy (CNN): 85.36333333333334 

2025-10-13 10:52:08,221 [trainer.py] => All params: 86858516
2025-10-13 10:52:08,221 [trainer.py] => Trainable params: 153800
2025-10-13 10:52:08,222 [sema.py] => Learning on 30-40
2025-10-13 11:05:29,704 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.136, Train_accy 95.57, Test_accy 78.79
2025-10-13 11:05:55,949 [trainer.py] => No NME accuracy.
2025-10-13 11:05:55,950 [trainer.py] => CNN: {'total': 78.79, '00-09': 73.72, '10-19': 78.81, '20-29': 83.33, '30-39': 79.35, 'old': 78.68, 'new': 79.35}
2025-10-13 11:05:55,950 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79]
2025-10-13 11:05:55,951 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79]

2025-10-13 11:05:55,951 [trainer.py] => Average Accuracy (CNN): 83.72000000000001 

2025-10-13 11:05:55,952 [trainer.py] => All params: 86858516
2025-10-13 11:05:55,952 [trainer.py] => Trainable params: 153800
2025-10-13 11:05:55,953 [sema.py] => Learning on 40-50
2025-10-13 11:21:53,164 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.219, Train_accy 93.21, Test_accy 75.82
2025-10-13 11:22:17,903 [trainer.py] => No NME accuracy.
2025-10-13 11:22:17,904 [trainer.py] => CNN: {'total': 75.82, '00-09': 73.08, '10-19': 76.82, '20-29': 81.48, '30-39': 77.17, '40-49': 68.81, 'old': 77.18, 'new': 68.81}
2025-10-13 11:22:17,904 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82]
2025-10-13 11:22:17,904 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78]

2025-10-13 11:22:17,905 [trainer.py] => Average Accuracy (CNN): 82.14000000000001 

2025-10-13 11:22:17,905 [trainer.py] => All params: 86858516
2025-10-13 11:22:17,906 [trainer.py] => Trainable params: 153800
2025-10-13 11:22:17,906 [sema.py] => Learning on 50-60
2025-10-13 11:42:00,938 [sema.py] => func Task 5, Epoch 20/20 => Loss 0.355, Train_accy 88.69, Test_accy 71.43
2025-10-13 11:42:39,433 [trainer.py] => No NME accuracy.
2025-10-13 11:42:39,433 [trainer.py] => CNN: {'total': 71.43, '00-09': 71.79, '10-19': 74.83, '20-29': 80.86, '30-39': 77.17, '40-49': 68.81, '50-59': 55.7, 'old': 74.93, 'new': 55.7}
2025-10-13 11:42:39,433 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43]
2025-10-13 11:42:39,434 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33]

2025-10-13 11:42:39,434 [trainer.py] => Average Accuracy (CNN): 80.355 

2025-10-13 11:42:39,435 [trainer.py] => All params: 86858516
2025-10-13 11:42:39,435 [trainer.py] => Trainable params: 153800
2025-10-13 11:42:39,435 [sema.py] => Learning on 60-70
2025-10-13 11:59:51,856 [sema.py] => func Task 6, Epoch 20/20 => Loss 0.230, Train_accy 93.78, Test_accy 69.90
2025-10-13 12:00:24,627 [trainer.py] => No NME accuracy.
2025-10-13 12:00:24,628 [trainer.py] => CNN: {'total': 69.9, '00-09': 69.87, '10-19': 73.51, '20-29': 75.31, '30-39': 76.09, '40-49': 66.06, '50-59': 53.69, '60-69': 76.56, 'old': 68.86, 'new': 76.56}
2025-10-13 12:00:24,628 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9]
2025-10-13 12:00:24,628 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18]

2025-10-13 12:00:24,628 [trainer.py] => Average Accuracy (CNN): 78.86142857142859 

2025-10-13 12:00:24,629 [trainer.py] => All params: 86858516
2025-10-13 12:00:24,630 [trainer.py] => Trainable params: 153800
2025-10-13 12:00:24,630 [sema.py] => Learning on 70-80
2025-10-13 12:00:30,779 [sema_block.py] => Adapter 10.1 added at block 10
2025-10-13 12:14:55,519 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.059, Train_accy 97.95, Test_accy 67.78
2025-10-13 12:31:15,678 [sema.py] => rd Task 7, Epoch 20/20 => Loss 0.337, Train_accy 97.95, Test_accy 67.78
2025-10-13 12:32:02,888 [trainer.py] => No NME accuracy.
2025-10-13 12:32:02,889 [trainer.py] => CNN: {'total': 67.78, '00-09': 66.03, '10-19': 73.51, '20-29': 70.37, '30-39': 72.83, '40-49': 62.39, '50-59': 54.36, '60-69': 74.22, '70-79': 75.68, 'old': 67.48, 'new': 75.68}
2025-10-13 12:32:02,889 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78]
2025-10-13 12:32:02,889 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63]

2025-10-13 12:32:02,889 [trainer.py] => Average Accuracy (CNN): 77.47625000000001 

2025-10-13 12:32:02,890 [trainer.py] => All params: 87082149
2025-10-13 12:32:02,890 [trainer.py] => Trainable params: 153800
2025-10-13 12:32:02,890 [sema.py] => Learning on 80-90
2025-10-13 12:32:09,308 [sema_block.py] => Adapter 11.1 added at block 11
2025-10-13 12:47:39,688 [sema.py] => func Task 8, Epoch 20/20 => Loss 0.148, Train_accy 96.19, Test_accy 67.31
2025-10-13 13:00:41,891 [sema.py] => rd Task 8, Epoch 20/20 => Loss 0.990, Train_accy 94.76, Test_accy 67.31
2025-10-13 13:02:22,411 [trainer.py] => No NME accuracy.
2025-10-13 13:02:22,411 [trainer.py] => CNN: {'total': 67.31, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 62.39, '50-59': 53.69, '60-69': 74.22, '70-79': 75.68, '80-89': 66.04, 'old': 67.38, 'new': 66.04}
2025-10-13 13:02:22,412 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31]
2025-10-13 13:02:22,412 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81]

2025-10-13 13:02:22,412 [trainer.py] => Average Accuracy (CNN): 76.34666666666668 

2025-10-13 13:02:22,413 [trainer.py] => All params: 87305782
2025-10-13 13:02:22,414 [trainer.py] => Trainable params: 153800
2025-10-13 13:02:22,414 [sema.py] => Learning on 90-100
2025-10-13 13:18:24,826 [sema.py] => func Task 9, Epoch 20/20 => Loss 0.132, Train_accy 95.83, Test_accy 66.21
2025-10-13 13:19:09,368 [trainer.py] => No NME accuracy.
2025-10-13 13:19:09,368 [trainer.py] => CNN: {'total': 66.21, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 62.39, '50-59': 53.02, '60-69': 74.22, '70-79': 75.68, '80-89': 60.38, '90-99': 51.02, 'old': 66.92, 'new': 51.02}
2025-10-13 13:19:09,369 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21]
2025-10-13 13:19:09,369 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66]

2025-10-13 13:19:09,369 [trainer.py] => Average Accuracy (CNN): 75.33300000000001 

2025-10-13 13:19:09,370 [trainer.py] => All params: 87305782
2025-10-13 13:19:09,371 [trainer.py] => Trainable params: 153800
2025-10-13 13:19:09,371 [sema.py] => Learning on 100-110
2025-10-13 13:34:36,887 [sema.py] => func Task 10, Epoch 20/20 => Loss 0.125, Train_accy 97.76, Test_accy 64.65
2025-10-13 13:35:26,206 [trainer.py] => No NME accuracy.
2025-10-13 13:35:26,206 [trainer.py] => CNN: {'total': 64.65, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 62.39, '50-59': 53.02, '60-69': 74.22, '70-79': 75.68, '80-89': 54.72, '90-99': 48.98, '100-109': 29.73, 'old': 65.84, 'new': 29.73}
2025-10-13 13:35:26,207 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65]
2025-10-13 13:35:26,207 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2]

2025-10-13 13:35:26,207 [trainer.py] => Average Accuracy (CNN): 74.3618181818182 

2025-10-13 13:35:26,208 [trainer.py] => All params: 87305782
2025-10-13 13:35:26,209 [trainer.py] => Trainable params: 153800
2025-10-13 13:35:26,209 [sema.py] => Learning on 110-120
2025-10-13 13:49:09,207 [sema.py] => func Task 11, Epoch 20/20 => Loss 0.116, Train_accy 97.62, Test_accy 63.70
2025-10-13 13:49:52,295 [trainer.py] => No NME accuracy.
2025-10-13 13:49:52,295 [trainer.py] => CNN: {'total': 63.7, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 62.39, '50-59': 53.02, '60-69': 73.44, '70-79': 70.27, '80-89': 54.72, '90-99': 44.9, '100-109': 29.73, '110-119': 47.06, 'old': 64.2, 'new': 47.06}
2025-10-13 13:49:52,296 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7]
2025-10-13 13:49:52,296 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57]

2025-10-13 13:49:52,296 [trainer.py] => Average Accuracy (CNN): 73.47333333333334 

2025-10-13 13:49:52,297 [trainer.py] => All params: 87305782
2025-10-13 13:49:52,297 [trainer.py] => Trainable params: 153800
2025-10-13 13:49:52,298 [sema.py] => Learning on 120-130
2025-10-13 14:05:05,408 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.145, Train_accy 96.72, Test_accy 62.32
2025-10-13 14:05:53,894 [trainer.py] => No NME accuracy.
2025-10-13 14:05:53,895 [trainer.py] => CNN: {'total': 62.32, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 61.47, '50-59': 53.02, '60-69': 73.44, '70-79': 67.57, '80-89': 52.83, '90-99': 44.9, '100-109': 27.03, '110-119': 47.06, '120-129': 41.07, 'old': 63.35, 'new': 41.07}
2025-10-13 14:05:53,895 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32]
2025-10-13 14:05:53,895 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68]

2025-10-13 14:05:53,895 [trainer.py] => Average Accuracy (CNN): 72.61538461538463 

2025-10-13 14:05:53,898 [trainer.py] => All params: 87305782
2025-10-13 14:05:53,898 [trainer.py] => Trainable params: 153800
2025-10-13 14:05:53,898 [sema.py] => Learning on 130-140
2025-10-13 14:21:23,013 [sema.py] => func Task 13, Epoch 20/20 => Loss 0.066, Train_accy 98.23, Test_accy 61.77
2025-10-13 14:21:57,918 [trainer.py] => No NME accuracy.
2025-10-13 14:21:57,918 [trainer.py] => CNN: {'total': 61.77, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 61.47, '50-59': 53.02, '60-69': 73.44, '70-79': 67.57, '80-89': 50.94, '90-99': 44.9, '100-109': 27.03, '110-119': 47.06, '120-129': 41.07, '130-139': 40.74, 'old': 62.24, 'new': 40.74}
2025-10-13 14:21:57,918 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77]
2025-10-13 14:21:57,919 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66]

2025-10-13 14:21:57,919 [trainer.py] => Average Accuracy (CNN): 71.8407142857143 

2025-10-13 14:21:57,919 [trainer.py] => All params: 87305782
2025-10-13 14:21:57,920 [trainer.py] => Trainable params: 153800
2025-10-13 14:21:57,920 [sema.py] => Learning on 140-150
2025-10-13 14:38:20,021 [sema.py] => func Task 14, Epoch 20/20 => Loss 0.145, Train_accy 94.64, Test_accy 60.96
2025-10-13 14:38:59,633 [trainer.py] => No NME accuracy.
2025-10-13 14:38:59,634 [trainer.py] => CNN: {'total': 60.96, '00-09': 65.38, '10-19': 73.51, '20-29': 70.37, '30-39': 70.65, '40-49': 61.47, '50-59': 53.02, '60-69': 73.44, '70-79': 67.57, '80-89': 49.06, '90-99': 44.9, '100-109': 27.03, '110-119': 44.12, '120-129': 39.29, '130-139': 40.74, '140-149': 47.06, 'old': 61.53, 'new': 47.06}
2025-10-13 14:38:59,634 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96]
2025-10-13 14:38:59,635 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64]

2025-10-13 14:38:59,635 [trainer.py] => Average Accuracy (CNN): 71.11533333333335 

2025-10-13 14:38:59,636 [trainer.py] => All params: 87305782
2025-10-13 14:38:59,637 [trainer.py] => Trainable params: 153800
2025-10-13 14:38:59,637 [sema.py] => Learning on 150-160
2025-10-13 14:39:04,341 [sema_block.py] => Adapter 11.2 added at block 11
2025-10-13 14:55:43,970 [sema.py] => func Task 15, Epoch 20/20 => Loss 0.081, Train_accy 97.32, Test_accy 60.23
2025-10-13 15:12:07,298 [sema.py] => rd Task 15, Epoch 20/20 => Loss 1.019, Train_accy 96.64, Test_accy 60.23
2025-10-13 15:12:37,245 [trainer.py] => No NME accuracy.
2025-10-13 15:12:37,245 [trainer.py] => CNN: {'total': 60.23, '00-09': 65.38, '10-19': 72.19, '20-29': 69.14, '30-39': 69.57, '40-49': 60.55, '50-59': 52.35, '60-69': 73.44, '70-79': 67.57, '80-89': 47.17, '90-99': 44.9, '100-109': 27.03, '110-119': 44.12, '120-129': 39.29, '130-139': 40.74, '140-149': 47.06, '150-159': 55.88, 'old': 60.34, 'new': 55.88}
2025-10-13 15:12:37,246 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96, 60.23]
2025-10-13 15:12:37,246 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64, 81.13]

2025-10-13 15:12:37,246 [trainer.py] => Average Accuracy (CNN): 70.43500000000002 

2025-10-13 15:12:37,247 [trainer.py] => All params: 87529415
2025-10-13 15:12:37,248 [trainer.py] => Trainable params: 153800
2025-10-13 15:12:37,248 [sema.py] => Learning on 160-170
2025-10-13 15:22:36,311 [sema.py] => func Task 16, Epoch 20/20 => Loss 0.151, Train_accy 95.77, Test_accy 58.91
2025-10-13 15:22:59,290 [trainer.py] => No NME accuracy.
2025-10-13 15:22:59,291 [trainer.py] => CNN: {'total': 58.91, '00-09': 65.38, '10-19': 71.52, '20-29': 69.14, '30-39': 68.48, '40-49': 59.63, '50-59': 52.35, '60-69': 73.44, '70-79': 67.57, '80-89': 45.28, '90-99': 44.9, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 40.74, '140-149': 45.1, '150-159': 55.88, '160-169': 44.0, 'old': 59.47, 'new': 44.0}
2025-10-13 15:22:59,291 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96, 60.23, 58.91]
2025-10-13 15:22:59,292 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64, 81.13, 80.29]

2025-10-13 15:22:59,293 [trainer.py] => Average Accuracy (CNN): 69.75705882352943 

2025-10-13 15:22:59,293 [trainer.py] => All params: 87529415
2025-10-13 15:22:59,294 [trainer.py] => Trainable params: 153800
2025-10-13 15:22:59,294 [sema.py] => Learning on 170-180
2025-10-13 15:33:00,564 [sema.py] => func Task 17, Epoch 20/20 => Loss 0.136, Train_accy 95.14, Test_accy 57.81
2025-10-13 15:33:27,181 [trainer.py] => No NME accuracy.
2025-10-13 15:33:27,182 [trainer.py] => CNN: {'total': 57.81, '00-09': 65.38, '10-19': 71.52, '20-29': 69.14, '30-39': 68.48, '40-49': 59.63, '50-59': 52.35, '60-69': 72.66, '70-79': 67.57, '80-89': 45.28, '90-99': 42.86, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 40.74, '140-149': 43.14, '150-159': 55.88, '160-169': 44.0, '170-179': 27.5, 'old': 58.69, 'new': 27.5}
2025-10-13 15:33:27,182 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96, 60.23, 58.91, 57.81]
2025-10-13 15:33:27,183 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64, 81.13, 80.29, 79.15]

2025-10-13 15:33:27,183 [trainer.py] => Average Accuracy (CNN): 69.09333333333335 

2025-10-13 15:33:27,184 [trainer.py] => All params: 87529415
2025-10-13 15:33:27,185 [trainer.py] => Trainable params: 153800
2025-10-13 15:33:27,185 [sema.py] => Learning on 180-190
2025-10-13 15:43:47,776 [sema.py] => func Task 18, Epoch 20/20 => Loss 0.099, Train_accy 98.20, Test_accy 57.61
2025-10-13 15:44:10,365 [trainer.py] => No NME accuracy.
2025-10-13 15:44:10,365 [trainer.py] => CNN: {'total': 57.61, '00-09': 65.38, '10-19': 71.52, '20-29': 68.52, '30-39': 68.48, '40-49': 59.63, '50-59': 51.01, '60-69': 72.66, '70-79': 67.57, '80-89': 45.28, '90-99': 42.86, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 40.74, '140-149': 43.14, '150-159': 55.88, '160-169': 44.0, '170-179': 27.5, '180-189': 58.0, 'old': 57.6, 'new': 58.0}
2025-10-13 15:44:10,365 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96, 60.23, 58.91, 57.81, 57.61]
2025-10-13 15:44:10,366 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64, 81.13, 80.29, 79.15, 78.84]

2025-10-13 15:44:10,366 [trainer.py] => Average Accuracy (CNN): 68.48894736842107 

2025-10-13 15:44:10,367 [trainer.py] => All params: 87529415
2025-10-13 15:44:10,367 [trainer.py] => Trainable params: 153800
2025-10-13 15:44:10,367 [sema.py] => Learning on 190-200
2025-10-13 15:44:14,133 [sema_block.py] => Adapter 10.2 added at block 10
2025-10-13 15:54:37,275 [sema.py] => func Task 19, Epoch 20/20 => Loss 0.091, Train_accy 97.44, Test_accy 57.01
2025-10-13 16:05:05,113 [sema.py] => rd Task 19, Epoch 20/20 => Loss 0.355, Train_accy 96.79, Test_accy 57.01
2025-10-13 16:05:05,205 [sema_block.py] => Adapter 11.3 added at block 11
2025-10-13 16:15:19,263 [sema.py] => func Task 19, Epoch 20/20 => Loss 0.056, Train_accy 98.72, Test_accy 56.95
2025-10-13 16:25:34,593 [sema.py] => rd Task 19, Epoch 20/20 => Loss 1.104, Train_accy 100.00, Test_accy 56.95
2025-10-13 16:26:09,553 [trainer.py] => No NME accuracy.
2025-10-13 16:26:09,556 [trainer.py] => CNN: {'total': 56.95, '00-09': 64.74, '10-19': 70.86, '20-29': 67.9, '30-39': 66.3, '40-49': 59.63, '50-59': 51.01, '60-69': 71.88, '70-79': 67.57, '80-89': 45.28, '90-99': 42.86, '100-109': 27.03, '110-119': 35.29, '120-129': 33.93, '130-139': 40.74, '140-149': 41.18, '150-159': 55.88, '160-169': 44.0, '170-179': 27.5, '180-189': 58.0, '190-199': 53.7, 'old': 57.06, 'new': 53.7}
2025-10-13 16:26:09,556 [trainer.py] => CNN top1 curve: [89.74, 84.69, 81.66, 78.79, 75.82, 71.43, 69.9, 67.78, 67.31, 66.21, 64.65, 63.7, 62.32, 61.77, 60.96, 60.23, 58.91, 57.81, 57.61, 56.95]
2025-10-13 16:26:09,557 [trainer.py] => CNN top5 curve: [99.36, 98.7, 98.08, 96.79, 94.78, 91.33, 90.18, 89.63, 88.81, 87.66, 86.2, 85.57, 83.68, 82.66, 81.64, 81.13, 80.29, 79.15, 78.84, 78.47]

2025-10-13 16:26:09,557 [trainer.py] => Average Accuracy (CNN): 67.912 

2025-11-18 06:10:16,829 [trainer.py] => config: exps/sema_ina.json
2025-11-18 06:10:16,829 [trainer.py] => eval: False
2025-11-18 06:10:16,829 [trainer.py] => prefix: reproduce
2025-11-18 06:10:16,830 [trainer.py] => dataset: imageneta
2025-11-18 06:10:16,830 [trainer.py] => memory_size: 2000
2025-11-18 06:10:16,830 [trainer.py] => memory_per_class: None
2025-11-18 06:10:16,830 [trainer.py] => fixed_memory: False
2025-11-18 06:10:16,831 [trainer.py] => shuffle: False
2025-11-18 06:10:16,831 [trainer.py] => init_cls: 10
2025-11-18 06:10:16,832 [trainer.py] => increment: 10
2025-11-18 06:10:16,832 [trainer.py] => model_name: sema
2025-11-18 06:10:16,832 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 06:10:16,854 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 06:10:16,854 [trainer.py] => seed: 1993
2025-11-18 06:10:16,854 [trainer.py] => batch_size: 32
2025-11-18 06:10:16,854 [trainer.py] => weight_decay: 0.0005
2025-11-18 06:10:16,854 [trainer.py] => min_lr: 0
2025-11-18 06:10:16,854 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 06:10:16,855 [trainer.py] => ffn_num: 16
2025-11-18 06:10:16,855 [trainer.py] => optimizer: sgd
2025-11-18 06:10:16,855 [trainer.py] => vpt_type: shallow
2025-11-18 06:10:16,855 [trainer.py] => prompt_token_num: 5
2025-11-18 06:10:16,855 [trainer.py] => func_epoch: 20
2025-11-18 06:10:16,855 [trainer.py] => rd_epoch: 20
2025-11-18 06:10:16,855 [trainer.py] => init_lr: 0.005
2025-11-18 06:10:16,856 [trainer.py] => rd_lr: 0.01
2025-11-18 06:10:16,856 [trainer.py] => rd_dim: 128
2025-11-18 06:10:16,856 [trainer.py] => buffer_size: 500
2025-11-18 06:10:16,856 [trainer.py] => detect_batch_size: 128
2025-11-18 06:10:16,856 [trainer.py] => exp_threshold: 1
2025-11-18 06:10:16,856 [trainer.py] => exp_k_std: 3.0
2025-11-18 06:10:16,856 [trainer.py] => router_attn_dim: 128
2025-11-18 06:10:16,856 [trainer.py] => adapt_start_layer: 9
2025-11-18 06:10:16,856 [trainer.py] => adapt_end_layer: 11
2025-11-18 06:10:16,933 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 06:10:18,522 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 06:10:18,549 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 06:10:18,578 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 06:10:18,608 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 06:10:18,636 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 06:10:18,664 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 06:10:18,692 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 06:10:18,722 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 06:10:18,752 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 06:10:18,785 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 06:10:18,815 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 06:10:18,846 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 06:10:19,432 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 06:10:20,506 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: eae26333-f0b6-42c8-bbf1-8e4f518d544d)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:20,507 [_http.py] => Retrying in 1s [Retry 1/5].
2025-11-18 06:10:21,527 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: af0324c1-4de3-43e0-8633-ba509cb241c7)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:21,528 [_http.py] => Retrying in 2s [Retry 2/5].
2025-11-18 06:10:23,543 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: ca7e675d-e13c-49cb-9403-aa82778932f0)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:23,543 [_http.py] => Retrying in 4s [Retry 3/5].
2025-11-18 06:10:27,565 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: 263909fe-34a9-42c8-bab7-2dfc4a01d652)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:27,566 [_http.py] => Retrying in 8s [Retry 4/5].
2025-11-18 06:10:35,582 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: a4d5733e-2d79-45fd-ba6a-9f360cf0f336)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:35,583 [_http.py] => Retrying in 8s [Retry 5/5].
2025-11-18 06:10:43,605 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: 06c0230d-9dd7-46ce-9cbf-8fba7ea95175)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:50,001 [trainer.py] => config: exps/sema_ina.json
2025-11-18 06:10:50,002 [trainer.py] => eval: False
2025-11-18 06:10:50,002 [trainer.py] => prefix: reproduce
2025-11-18 06:10:50,002 [trainer.py] => dataset: imageneta
2025-11-18 06:10:50,002 [trainer.py] => memory_size: 2000
2025-11-18 06:10:50,003 [trainer.py] => memory_per_class: None
2025-11-18 06:10:50,003 [trainer.py] => fixed_memory: False
2025-11-18 06:10:50,003 [trainer.py] => shuffle: False
2025-11-18 06:10:50,003 [trainer.py] => init_cls: 10
2025-11-18 06:10:50,003 [trainer.py] => increment: 10
2025-11-18 06:10:50,003 [trainer.py] => model_name: sema
2025-11-18 06:10:50,004 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 06:10:50,004 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 06:10:50,004 [trainer.py] => seed: 1993
2025-11-18 06:10:50,004 [trainer.py] => batch_size: 32
2025-11-18 06:10:50,004 [trainer.py] => weight_decay: 0.0005
2025-11-18 06:10:50,004 [trainer.py] => min_lr: 0
2025-11-18 06:10:50,004 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 06:10:50,004 [trainer.py] => ffn_num: 16
2025-11-18 06:10:50,005 [trainer.py] => optimizer: sgd
2025-11-18 06:10:50,005 [trainer.py] => vpt_type: shallow
2025-11-18 06:10:50,005 [trainer.py] => prompt_token_num: 5
2025-11-18 06:10:50,005 [trainer.py] => func_epoch: 20
2025-11-18 06:10:50,005 [trainer.py] => rd_epoch: 20
2025-11-18 06:10:50,005 [trainer.py] => init_lr: 0.005
2025-11-18 06:10:50,005 [trainer.py] => rd_lr: 0.01
2025-11-18 06:10:50,005 [trainer.py] => rd_dim: 128
2025-11-18 06:10:50,006 [trainer.py] => buffer_size: 500
2025-11-18 06:10:50,006 [trainer.py] => detect_batch_size: 128
2025-11-18 06:10:50,006 [trainer.py] => exp_threshold: 1
2025-11-18 06:10:50,006 [trainer.py] => exp_k_std: 3.0
2025-11-18 06:10:50,006 [trainer.py] => router_attn_dim: 128
2025-11-18 06:10:50,006 [trainer.py] => adapt_start_layer: 9
2025-11-18 06:10:50,006 [trainer.py] => adapt_end_layer: 11
2025-11-18 06:10:50,019 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 06:10:50,892 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 06:10:50,919 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 06:10:50,946 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 06:10:50,973 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 06:10:51,004 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 06:10:51,033 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 06:10:51,061 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 06:10:51,088 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 06:10:51,114 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 06:10:51,144 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 06:10:51,174 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 06:10:51,203 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 06:10:51,752 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 06:10:52,193 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: c650cdd8-0546-4d24-bcfd-f20d569721b2)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:52,194 [_http.py] => Retrying in 1s [Retry 1/5].
2025-11-18 06:10:53,213 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: 7ac2bd5d-7496-4395-81e1-6990da9e604c)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:53,213 [_http.py] => Retrying in 2s [Retry 2/5].
2025-11-18 06:10:55,223 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: 68403d5c-9481-4d61-a771-152222566474)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:55,224 [_http.py] => Retrying in 4s [Retry 3/5].
2025-11-18 06:10:59,240 [_http.py] => '(MaxRetryError('HTTPSConnectionPool(host=\'huggingface.co\', port=443): Max retries exceeded with url: /timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors (Caused by SSLError(SSLCertVerificationError(1, "[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: Hostname mismatch, certificate is not valid for \'huggingface.co\'. (_ssl.c:1016)")))'), '(Request ID: 9f06065f-cca9-4362-b130-c982f2746812)')' thrown while requesting HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors
2025-11-18 06:10:59,240 [_http.py] => Retrying in 8s [Retry 4/5].
2025-11-18 06:11:07,516 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-18 06:11:07,691 [trainer.py] => All params: 89057868
2025-11-18 06:11:07,693 [trainer.py] => Trainable params: 3259212
2025-11-18 06:11:07,695 [sema.py] => Learning on 0-10
2025-11-18 06:12:10,284 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:13:13,829 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:13:14,537 [sema.py] => Building rehearsal memory...
2025-11-18 06:13:14,537 [base.py] => Constructing exemplars...(200 per classes)
2025-11-18 06:21:11,500 [trainer.py] => config: exps/sema_ina.json
2025-11-18 06:21:11,500 [trainer.py] => eval: False
2025-11-18 06:21:11,500 [trainer.py] => prefix: reproduce
2025-11-18 06:21:11,500 [trainer.py] => dataset: imageneta
2025-11-18 06:21:11,501 [trainer.py] => memory_size: 2000
2025-11-18 06:21:11,501 [trainer.py] => memory_per_class: None
2025-11-18 06:21:11,501 [trainer.py] => fixed_memory: False
2025-11-18 06:21:11,501 [trainer.py] => shuffle: False
2025-11-18 06:21:11,502 [trainer.py] => init_cls: 10
2025-11-18 06:21:11,502 [trainer.py] => increment: 10
2025-11-18 06:21:11,502 [trainer.py] => model_name: sema
2025-11-18 06:21:11,502 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 06:21:11,502 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 06:21:11,503 [trainer.py] => seed: 1993
2025-11-18 06:21:11,503 [trainer.py] => batch_size: 32
2025-11-18 06:21:11,503 [trainer.py] => weight_decay: 0.0005
2025-11-18 06:21:11,503 [trainer.py] => min_lr: 0
2025-11-18 06:21:11,503 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 06:21:11,503 [trainer.py] => ffn_num: 16
2025-11-18 06:21:11,503 [trainer.py] => optimizer: sgd
2025-11-18 06:21:11,504 [trainer.py] => vpt_type: shallow
2025-11-18 06:21:11,504 [trainer.py] => prompt_token_num: 5
2025-11-18 06:21:11,504 [trainer.py] => func_epoch: 20
2025-11-18 06:21:11,504 [trainer.py] => rd_epoch: 20
2025-11-18 06:21:11,504 [trainer.py] => init_lr: 0.005
2025-11-18 06:21:11,504 [trainer.py] => rd_lr: 0.01
2025-11-18 06:21:11,504 [trainer.py] => rd_dim: 128
2025-11-18 06:21:11,504 [trainer.py] => buffer_size: 500
2025-11-18 06:21:11,505 [trainer.py] => detect_batch_size: 128
2025-11-18 06:21:11,505 [trainer.py] => exp_threshold: 1
2025-11-18 06:21:11,505 [trainer.py] => exp_k_std: 3.0
2025-11-18 06:21:11,505 [trainer.py] => router_attn_dim: 128
2025-11-18 06:21:11,505 [trainer.py] => adapt_start_layer: 9
2025-11-18 06:21:11,505 [trainer.py] => adapt_end_layer: 11
2025-11-18 06:21:11,517 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 06:21:12,381 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 06:21:12,409 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 06:21:12,437 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 06:21:12,466 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 06:21:12,494 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 06:21:12,522 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 06:21:12,551 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 06:21:12,580 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 06:21:12,607 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 06:21:12,637 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 06:21:12,666 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 06:21:12,694 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 06:21:13,234 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 06:21:13,854 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-18 06:21:13,960 [trainer.py] => All params: 89057868
2025-11-18 06:21:13,961 [trainer.py] => Trainable params: 3259212
2025-11-18 06:21:13,964 [sema.py] => Learning on 0-10
2025-11-18 06:22:14,894 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:23:17,668 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:23:18,357 [sema.py] => Building rehearsal memory...
2025-11-18 06:23:18,358 [base.py] => Constructing exemplars...(200 per classes)
2025-11-18 06:48:02,573 [trainer.py] => config: exps/sema_ina.json
2025-11-18 06:48:02,574 [trainer.py] => eval: False
2025-11-18 06:48:02,574 [trainer.py] => prefix: reproduce
2025-11-18 06:48:02,574 [trainer.py] => dataset: imageneta
2025-11-18 06:48:02,574 [trainer.py] => memory_size: 2000
2025-11-18 06:48:02,574 [trainer.py] => memory_per_class: None
2025-11-18 06:48:02,575 [trainer.py] => fixed_memory: False
2025-11-18 06:48:02,575 [trainer.py] => shuffle: False
2025-11-18 06:48:02,575 [trainer.py] => init_cls: 10
2025-11-18 06:48:02,575 [trainer.py] => increment: 10
2025-11-18 06:48:02,576 [trainer.py] => model_name: sema
2025-11-18 06:48:02,576 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 06:48:02,576 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 06:48:02,576 [trainer.py] => seed: 1993
2025-11-18 06:48:02,576 [trainer.py] => batch_size: 32
2025-11-18 06:48:02,577 [trainer.py] => weight_decay: 0.0005
2025-11-18 06:48:02,577 [trainer.py] => min_lr: 0
2025-11-18 06:48:02,577 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 06:48:02,577 [trainer.py] => ffn_num: 16
2025-11-18 06:48:02,577 [trainer.py] => optimizer: sgd
2025-11-18 06:48:02,578 [trainer.py] => vpt_type: shallow
2025-11-18 06:48:02,578 [trainer.py] => prompt_token_num: 5
2025-11-18 06:48:02,578 [trainer.py] => func_epoch: 20
2025-11-18 06:48:02,578 [trainer.py] => rd_epoch: 20
2025-11-18 06:48:02,578 [trainer.py] => init_lr: 0.005
2025-11-18 06:48:02,578 [trainer.py] => rd_lr: 0.01
2025-11-18 06:48:02,578 [trainer.py] => rd_dim: 128
2025-11-18 06:48:02,578 [trainer.py] => buffer_size: 500
2025-11-18 06:48:02,579 [trainer.py] => detect_batch_size: 128
2025-11-18 06:48:02,579 [trainer.py] => exp_threshold: 1
2025-11-18 06:48:02,579 [trainer.py] => exp_k_std: 3.0
2025-11-18 06:48:02,579 [trainer.py] => router_attn_dim: 128
2025-11-18 06:48:02,579 [trainer.py] => adapt_start_layer: 9
2025-11-18 06:48:02,579 [trainer.py] => adapt_end_layer: 11
2025-11-18 06:48:02,645 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 06:48:04,024 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 06:48:04,052 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 06:48:04,079 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 06:48:04,107 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 06:48:04,134 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 06:48:04,162 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 06:48:04,189 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 06:48:04,217 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 06:48:04,245 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 06:48:04,274 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 06:48:04,306 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 06:48:04,335 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 06:48:04,916 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 06:48:05,452 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-18 06:48:05,637 [trainer.py] => All params: 89057868
2025-11-18 06:48:05,638 [trainer.py] => Trainable params: 3259212
2025-11-18 06:48:05,640 [sema.py] => Learning on 0-10
2025-11-18 06:49:07,837 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:50:09,936 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-18 06:50:10,627 [sema.py] => Building rehearsal memory...
2025-11-18 06:50:10,628 [base.py] => Constructing exemplars...(200 per classes)
2025-11-18 06:50:19,490 [sema.py] => Memory size: 660
2025-11-18 06:50:19,491 [trainer.py] => No NME accuracy.
2025-11-18 06:50:19,491 [trainer.py] => CNN: {'total': 92.95, '00-09': 92.95, 'old': 0, 'new': 92.95}
2025-11-18 06:50:19,491 [trainer.py] => CNN top1 curve: [92.95]
2025-11-18 06:50:19,491 [trainer.py] => CNN top5 curve: [99.36]

2025-11-18 06:50:19,492 [trainer.py] => Average Accuracy (CNN): 92.95 

2025-11-18 06:50:19,492 [trainer.py] => All params: 89211668
2025-11-18 06:50:19,493 [trainer.py] => Trainable params: 2516180
2025-11-18 06:50:19,493 [sema.py] => Learning on 10-20
2025-11-18 06:50:19,494 [sema.py] => [DEBUG] Task 1: New data size: 599, Memory Size: 660, Total Dataset Size: 1259
2025-11-18 06:51:41,495 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.314, Train_accy 90.87, Test_accy 85.67
2025-11-18 06:51:43,681 [sema.py] => Building rehearsal memory...
2025-11-18 06:51:43,682 [base.py] => Reducing exemplars...(100 per classes)
2025-11-18 06:51:48,007 [base.py] => Constructing exemplars...(100 per classes)
2025-11-18 06:51:56,374 [sema.py] => Memory size: 1259
2025-11-18 06:51:56,374 [trainer.py] => CNN: {'total': 85.67, '00-09': 84.62, '10-19': 86.75, 'old': 84.62, 'new': 86.75}
2025-11-18 06:51:56,375 [trainer.py] => NME: {'total': 45.28, '00-09': 89.1, '10-19': 0.0, 'old': 89.1, 'new': 0.0}
2025-11-18 06:51:56,375 [trainer.py] => CNN top1 curve: [92.95, 85.67]
2025-11-18 06:51:56,375 [trainer.py] => CNN top5 curve: [99.36, 98.05]
2025-11-18 06:51:56,375 [trainer.py] => NME top1 curve: [45.28]
2025-11-18 06:51:56,375 [trainer.py] => NME top5 curve: [50.81]

2025-11-18 06:51:56,375 [trainer.py] => Average Accuracy (CNN): 89.31
2025-11-18 06:51:56,376 [trainer.py] => Average Accuracy (NME): 45.28
2025-11-18 06:51:56,376 [trainer.py] => All params: 89211668
2025-11-18 06:51:56,377 [trainer.py] => Trainable params: 2516180
2025-11-18 06:51:56,377 [sema.py] => Learning on 20-30
2025-11-18 06:51:56,378 [sema.py] => [DEBUG] Task 2: New data size: 636, Memory Size: 1259, Total Dataset Size: 1895
2025-11-18 06:51:59,775 [sema_block.py] => Adapter 11.1 added at block 11
2025-11-18 06:53:52,733 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.355, Train_accy 89.55, Test_accy 85.50
2025-11-18 06:55:08,698 [sema.py] => rd Task 2, Epoch 20/20 => Loss 0.657, Train_accy 90.41, Test_accy 85.50
2025-11-18 06:55:21,230 [sema.py] => Building rehearsal memory...
2025-11-18 06:55:21,230 [base.py] => Reducing exemplars...(66 per classes)
2025-11-18 06:55:29,802 [base.py] => Constructing exemplars...(66 per classes)
2025-11-18 06:55:38,212 [sema.py] => Memory size: 1730
2025-11-18 06:55:38,212 [trainer.py] => CNN: {'total': 85.5, '00-09': 81.41, '10-19': 86.75, '20-29': 88.27, 'old': 84.04, 'new': 88.27}
2025-11-18 06:55:38,212 [trainer.py] => NME: {'total': 57.14, '00-09': 87.82, '10-19': 86.75, '20-29': 0.0, 'old': 87.3, 'new': 0.0}
2025-11-18 06:55:38,213 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5]
2025-11-18 06:55:38,213 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08]
2025-11-18 06:55:38,213 [trainer.py] => NME top1 curve: [45.28, 57.14]
2025-11-18 06:55:38,213 [trainer.py] => NME top5 curve: [50.81, 65.03]

2025-11-18 06:55:38,214 [trainer.py] => Average Accuracy (CNN): 88.04
2025-11-18 06:55:38,214 [trainer.py] => Average Accuracy (NME): 51.21
2025-11-18 06:55:38,214 [trainer.py] => All params: 89434532
2025-11-18 06:55:38,215 [trainer.py] => Trainable params: 2516180
2025-11-18 06:55:38,215 [sema.py] => Learning on 30-40
2025-11-18 06:55:38,216 [sema.py] => [DEBUG] Task 3: New data size: 361, Memory Size: 1730, Total Dataset Size: 2091
2025-11-18 06:57:54,130 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.345, Train_accy 90.48, Test_accy 82.17
2025-11-18 06:57:57,875 [sema.py] => Building rehearsal memory...
2025-11-18 06:57:57,876 [base.py] => Reducing exemplars...(50 per classes)
2025-11-18 06:58:08,623 [base.py] => Constructing exemplars...(50 per classes)
2025-11-18 06:58:14,138 [sema.py] => Memory size: 1749
2025-11-18 06:58:14,139 [trainer.py] => CNN: {'total': 82.17, '00-09': 76.92, '10-19': 86.09, '20-29': 85.19, '30-39': 79.35, 'old': 82.73, 'new': 79.35}
2025-11-18 06:58:14,139 [trainer.py] => NME: {'total': 69.7, '00-09': 83.97, '10-19': 82.12, '20-29': 83.95, '30-39': 0.0, 'old': 83.37, 'new': 0.0}
2025-11-18 06:58:14,139 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17]
2025-11-18 06:58:14,139 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5]
2025-11-18 06:58:14,140 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7]
2025-11-18 06:58:14,140 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35]

2025-11-18 06:58:14,140 [trainer.py] => Average Accuracy (CNN): 86.5725
2025-11-18 06:58:14,140 [trainer.py] => Average Accuracy (NME): 57.373333333333335
2025-11-18 06:58:14,141 [trainer.py] => All params: 89434532
2025-11-18 06:58:14,142 [trainer.py] => Trainable params: 2516180
2025-11-18 06:58:14,142 [sema.py] => Learning on 40-50
2025-11-18 06:58:14,143 [sema.py] => [DEBUG] Task 4: New data size: 427, Memory Size: 1749, Total Dataset Size: 2176
2025-11-18 06:58:16,045 [sema_block.py] => Adapter 9.1 added at block 9
2025-11-18 07:00:40,160 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.320, Train_accy 91.08, Test_accy 79.25
2025-11-18 07:02:04,714 [sema.py] => rd Task 4, Epoch 20/20 => Loss 0.106, Train_accy 89.46, Test_accy 79.25
2025-11-18 07:02:22,240 [sema.py] => Building rehearsal memory...
2025-11-18 07:02:22,241 [base.py] => Reducing exemplars...(40 per classes)
2025-11-18 07:02:34,308 [base.py] => Constructing exemplars...(40 per classes)
2025-11-18 07:02:40,601 [sema.py] => Memory size: 1760
2025-11-18 07:02:40,601 [trainer.py] => CNN: {'total': 79.25, '00-09': 76.92, '10-19': 82.12, '20-29': 85.19, '30-39': 71.74, '40-49': 76.15, 'old': 79.86, 'new': 76.15}
2025-11-18 07:02:40,602 [trainer.py] => NME: {'total': 67.76, '00-09': 80.77, '10-19': 82.12, '20-29': 80.86, '30-39': 79.35, '40-49': 0.0, 'old': 80.93, 'new': 0.0}
2025-11-18 07:02:40,602 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25]
2025-11-18 07:02:40,602 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33]
2025-11-18 07:02:40,602 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76]
2025-11-18 07:02:40,602 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79]

2025-11-18 07:02:40,603 [trainer.py] => Average Accuracy (CNN): 85.108
2025-11-18 07:02:40,603 [trainer.py] => Average Accuracy (NME): 59.97
2025-11-18 07:02:40,603 [trainer.py] => All params: 89657396
2025-11-18 07:02:40,604 [trainer.py] => Trainable params: 2516180
2025-11-18 07:02:40,604 [sema.py] => Learning on 50-60
2025-11-18 07:02:40,605 [sema.py] => [DEBUG] Task 5: New data size: 566, Memory Size: 1760, Total Dataset Size: 2326
2025-11-18 07:05:27,872 [sema.py] => func Task 5, Epoch 20/20 => Loss 0.337, Train_accy 90.67, Test_accy 73.63
2025-11-18 07:05:33,350 [sema.py] => Building rehearsal memory...
2025-11-18 07:05:33,351 [base.py] => Reducing exemplars...(33 per classes)
2025-11-18 07:05:46,984 [base.py] => Constructing exemplars...(33 per classes)
2025-11-18 07:05:54,588 [sema.py] => Memory size: 1792
2025-11-18 07:05:54,589 [trainer.py] => CNN: {'total': 73.63, '00-09': 75.0, '10-19': 77.48, '20-29': 80.86, '30-39': 68.48, '40-49': 72.48, '50-59': 64.43, 'old': 75.67, 'new': 64.43}
2025-11-18 07:05:54,589 [trainer.py] => NME: {'total': 64.84, '00-09': 79.49, '10-19': 80.79, '20-29': 80.25, '30-39': 76.09, '40-49': 77.98, '50-59': 0.0, 'old': 79.25, 'new': 0.0}
2025-11-18 07:05:54,589 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63]
2025-11-18 07:05:54,590 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94]
2025-11-18 07:05:54,590 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84]
2025-11-18 07:05:54,590 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37]

2025-11-18 07:05:54,590 [trainer.py] => Average Accuracy (CNN): 83.19500000000001
2025-11-18 07:05:54,590 [trainer.py] => Average Accuracy (NME): 60.944
2025-11-18 07:05:54,591 [trainer.py] => All params: 89657396
2025-11-18 07:05:54,592 [trainer.py] => Trainable params: 2516180
2025-11-18 07:05:54,592 [sema.py] => Learning on 60-70
2025-11-18 07:05:54,593 [sema.py] => [DEBUG] Task 6: New data size: 450, Memory Size: 1792, Total Dataset Size: 2242
2025-11-18 07:08:43,118 [sema.py] => func Task 6, Epoch 20/20 => Loss 0.326, Train_accy 90.81, Test_accy 72.44
2025-11-18 07:08:49,795 [sema.py] => Building rehearsal memory...
2025-11-18 07:08:49,796 [base.py] => Reducing exemplars...(28 per classes)
2025-11-18 07:09:04,914 [base.py] => Constructing exemplars...(28 per classes)
2025-11-18 07:09:10,473 [sema.py] => Memory size: 1807
2025-11-18 07:09:10,474 [trainer.py] => CNN: {'total': 72.44, '00-09': 73.72, '10-19': 75.5, '20-29': 79.63, '30-39': 65.22, '40-49': 64.22, '50-59': 63.09, '60-69': 81.25, 'old': 71.06, 'new': 81.25}
2025-11-18 07:09:10,474 [trainer.py] => NME: {'total': 66.63, '00-09': 79.49, '10-19': 78.15, '20-29': 80.25, '30-39': 76.09, '40-49': 74.31, '50-59': 72.48, '60-69': 0.0, 'old': 77.05, 'new': 0.0}
2025-11-18 07:09:10,474 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44]
2025-11-18 07:09:10,475 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02]
2025-11-18 07:09:10,475 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63]
2025-11-18 07:09:10,475 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26]

2025-11-18 07:09:10,475 [trainer.py] => Average Accuracy (CNN): 81.65857142857143
2025-11-18 07:09:10,475 [trainer.py] => Average Accuracy (NME): 61.89166666666667
2025-11-18 07:09:10,476 [trainer.py] => All params: 89657396
2025-11-18 07:09:10,477 [trainer.py] => Trainable params: 2516180
2025-11-18 07:09:10,477 [sema.py] => Learning on 70-80
2025-11-18 07:09:10,478 [sema.py] => [DEBUG] Task 7: New data size: 146, Memory Size: 1807, Total Dataset Size: 1953
2025-11-18 07:09:16,545 [sema_block.py] => Adapter 9.2 added at block 9
2025-11-18 07:11:54,697 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.308, Train_accy 92.11, Test_accy 70.93
2025-11-18 07:13:33,902 [sema.py] => rd Task 7, Epoch 20/20 => Loss 0.091, Train_accy 95.21, Test_accy 70.93
2025-11-18 07:13:48,047 [sema.py] => Building rehearsal memory...
2025-11-18 07:13:48,047 [base.py] => Reducing exemplars...(25 per classes)
2025-11-18 07:14:04,694 [base.py] => Constructing exemplars...(25 per classes)
2025-11-18 07:14:08,412 [sema.py] => Memory size: 1772
2025-11-18 07:14:08,413 [trainer.py] => CNN: {'total': 70.93, '00-09': 73.72, '10-19': 75.5, '20-29': 79.63, '30-39': 63.04, '40-49': 65.14, '50-59': 63.09, '60-69': 75.0, '70-79': 56.76, 'old': 71.49, 'new': 56.76}
2025-11-18 07:14:08,413 [trainer.py] => NME: {'total': 72.56, '00-09': 78.85, '10-19': 78.15, '20-29': 79.01, '30-39': 76.09, '40-49': 67.89, '50-59': 71.14, '60-69': 74.22, '70-79': 0.0, 'old': 75.4, 'new': 0.0}
2025-11-18 07:14:08,413 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44, 70.93]
2025-11-18 07:14:08,414 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02, 90.04]
2025-11-18 07:14:08,414 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63, 72.56]
2025-11-18 07:14:08,414 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26, 91.06]

2025-11-18 07:14:08,415 [trainer.py] => Average Accuracy (CNN): 80.3175
2025-11-18 07:14:08,415 [trainer.py] => Average Accuracy (NME): 63.41571428571429
2025-11-18 07:14:08,416 [trainer.py] => All params: 89880260
2025-11-18 07:14:08,416 [trainer.py] => Trainable params: 2516180
2025-11-18 07:14:08,416 [sema.py] => Learning on 80-90
2025-11-18 07:14:08,417 [sema.py] => [DEBUG] Task 8: New data size: 210, Memory Size: 1772, Total Dataset Size: 1982
2025-11-18 07:16:57,618 [sema.py] => func Task 8, Epoch 20/20 => Loss 0.274, Train_accy 93.34, Test_accy 69.72
2025-11-18 07:17:05,338 [sema.py] => Building rehearsal memory...
2025-11-18 07:17:05,338 [base.py] => Reducing exemplars...(22 per classes)
2025-11-18 07:17:23,353 [base.py] => Constructing exemplars...(22 per classes)
2025-11-18 07:17:27,871 [sema.py] => Memory size: 1767
2025-11-18 07:17:27,871 [trainer.py] => CNN: {'total': 69.72, '00-09': 72.44, '10-19': 74.83, '20-29': 80.86, '30-39': 63.04, '40-49': 63.3, '50-59': 58.39, '60-69': 73.44, '70-79': 54.05, '80-89': 71.7, 'old': 69.61, 'new': 71.7}
2025-11-18 07:17:27,872 [trainer.py] => NME: {'total': 70.49, '00-09': 78.21, '10-19': 79.47, '20-29': 79.01, '30-39': 76.09, '40-49': 62.39, '50-59': 69.8, '60-69': 72.66, '70-79': 70.27, '80-89': 0.0, 'old': 74.29, 'new': 0.0}
2025-11-18 07:17:27,872 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44, 70.93, 69.72]
2025-11-18 07:17:27,872 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02, 90.04, 89.01]
2025-11-18 07:17:27,872 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63, 72.56, 70.49]
2025-11-18 07:17:27,872 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26, 91.06, 88.91]

2025-11-18 07:17:27,873 [trainer.py] => Average Accuracy (CNN): 79.14
2025-11-18 07:17:27,873 [trainer.py] => Average Accuracy (NME): 64.3
2025-11-18 07:17:27,874 [trainer.py] => All params: 89880260
2025-11-18 07:17:27,874 [trainer.py] => Trainable params: 2516180
2025-11-18 07:17:27,875 [sema.py] => Learning on 90-100
2025-11-18 07:17:27,875 [sema.py] => [DEBUG] Task 9: New data size: 216, Memory Size: 1767, Total Dataset Size: 1983
2025-11-18 07:20:15,936 [sema.py] => func Task 9, Epoch 20/20 => Loss 0.261, Train_accy 93.39, Test_accy 67.22
2025-11-18 07:20:23,301 [sema.py] => Building rehearsal memory...
2025-11-18 07:20:23,302 [base.py] => Reducing exemplars...(20 per classes)
2025-11-18 07:20:44,511 [base.py] => Constructing exemplars...(20 per classes)
2025-11-18 07:20:48,824 [sema.py] => Memory size: 1776
2025-11-18 07:20:48,825 [trainer.py] => CNN: {'total': 67.22, '00-09': 72.44, '10-19': 71.52, '20-29': 75.31, '30-39': 61.96, '40-49': 60.55, '50-59': 60.4, '60-69': 71.88, '70-79': 54.05, '80-89': 60.38, '90-99': 61.22, 'old': 67.5, 'new': 61.22}
2025-11-18 07:20:48,825 [trainer.py] => NME: {'total': 70.17, '00-09': 76.92, '10-19': 78.15, '20-29': 76.54, '30-39': 73.91, '40-49': 63.3, '50-59': 71.14, '60-69': 71.09, '70-79': 64.86, '80-89': 79.25, '90-99': 0.0, 'old': 73.48, 'new': 0.0}
2025-11-18 07:20:48,825 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44, 70.93, 69.72, 67.22]
2025-11-18 07:20:48,825 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02, 90.04, 89.01, 88.03]
2025-11-18 07:20:48,826 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63, 72.56, 70.49, 70.17]
2025-11-18 07:20:48,826 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26, 91.06, 88.91, 88.77]

2025-11-18 07:20:48,826 [trainer.py] => Average Accuracy (CNN): 77.94800000000001
2025-11-18 07:20:48,826 [trainer.py] => Average Accuracy (NME): 64.95222222222222
2025-11-18 07:20:48,827 [trainer.py] => All params: 89880260
2025-11-18 07:20:48,827 [trainer.py] => Trainable params: 2516180
2025-11-18 07:20:48,828 [sema.py] => Learning on 100-110
2025-11-18 07:20:48,828 [sema.py] => [DEBUG] Task 10: New data size: 134, Memory Size: 1776, Total Dataset Size: 1910
2025-11-18 07:23:40,836 [sema.py] => func Task 10, Epoch 20/20 => Loss 0.238, Train_accy 94.03, Test_accy 66.70
2025-11-18 07:23:48,415 [sema.py] => Building rehearsal memory...
2025-11-18 07:23:48,416 [base.py] => Reducing exemplars...(18 per classes)
2025-11-18 07:24:10,860 [base.py] => Constructing exemplars...(18 per classes)
2025-11-18 07:24:14,570 [sema.py] => Memory size: 1744
2025-11-18 07:24:14,571 [trainer.py] => CNN: {'total': 66.7, '00-09': 69.87, '10-19': 75.5, '20-29': 75.93, '30-39': 63.04, '40-49': 61.47, '50-59': 62.42, '60-69': 71.88, '70-79': 54.05, '80-89': 58.49, '90-99': 55.1, '100-109': 40.54, 'old': 67.59, 'new': 40.54}
2025-11-18 07:24:14,571 [trainer.py] => NME: {'total': 70.44, '00-09': 78.85, '10-19': 78.15, '20-29': 78.4, '30-39': 73.91, '40-49': 62.39, '50-59': 73.15, '60-69': 69.53, '70-79': 64.86, '80-89': 69.81, '90-99': 57.14, '100-109': 0.0, 'old': 72.84, 'new': 0.0}
2025-11-18 07:24:14,571 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44, 70.93, 69.72, 67.22, 66.7]
2025-11-18 07:24:14,572 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02, 90.04, 89.01, 88.03, 86.29]
2025-11-18 07:24:14,572 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63, 72.56, 70.49, 70.17, 70.44]
2025-11-18 07:24:14,572 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26, 91.06, 88.91, 88.77, 89.58]

2025-11-18 07:24:14,572 [trainer.py] => Average Accuracy (CNN): 76.92545454545456
2025-11-18 07:24:14,572 [trainer.py] => Average Accuracy (NME): 65.501
2025-11-18 07:24:14,573 [trainer.py] => All params: 89880260
2025-11-18 07:24:14,573 [trainer.py] => Trainable params: 2516180
2025-11-18 07:24:14,574 [sema.py] => Learning on 110-120
2025-11-18 07:24:14,574 [sema.py] => [DEBUG] Task 11: New data size: 126, Memory Size: 1744, Total Dataset Size: 1870
2025-11-18 07:27:07,181 [sema.py] => func Task 11, Epoch 20/20 => Loss 0.236, Train_accy 94.12, Test_accy 66.21
2025-11-18 07:27:15,064 [sema.py] => Building rehearsal memory...
2025-11-18 07:27:15,064 [base.py] => Reducing exemplars...(16 per classes)
2025-11-18 07:27:38,818 [base.py] => Constructing exemplars...(16 per classes)
2025-11-18 07:27:42,671 [sema.py] => Memory size: 1691
2025-11-18 07:27:42,672 [trainer.py] => CNN: {'total': 66.21, '00-09': 69.87, '10-19': 73.51, '20-29': 74.69, '30-39': 66.3, '40-49': 62.39, '50-59': 61.74, '60-69': 72.66, '70-79': 51.35, '80-89': 50.94, '90-99': 51.02, '100-109': 48.65, '110-119': 64.71, 'old': 66.25, 'new': 64.71}
2025-11-18 07:27:42,672 [trainer.py] => NME: {'total': 68.89, '00-09': 77.56, '10-19': 78.15, '20-29': 77.16, '30-39': 72.83, '40-49': 62.39, '50-59': 70.47, '60-69': 70.31, '70-79': 64.86, '80-89': 64.15, '90-99': 53.06, '100-109': 51.35, '110-119': 0.0, 'old': 70.97, 'new': 0.0}
2025-11-18 07:27:42,672 [trainer.py] => CNN top1 curve: [92.95, 85.67, 85.5, 82.17, 79.25, 73.63, 72.44, 70.93, 69.72, 67.22, 66.7, 66.21]
2025-11-18 07:27:42,673 [trainer.py] => CNN top5 curve: [99.36, 98.05, 98.08, 97.5, 94.33, 91.94, 91.02, 90.04, 89.01, 88.03, 86.29, 84.87]
2025-11-18 07:27:42,673 [trainer.py] => NME top1 curve: [45.28, 57.14, 69.7, 67.76, 64.84, 66.63, 72.56, 70.49, 70.17, 70.44, 68.89]
2025-11-18 07:27:42,673 [trainer.py] => NME top5 curve: [50.81, 65.03, 82.35, 81.79, 79.37, 82.26, 91.06, 88.91, 88.77, 89.58, 88.59]

2025-11-18 07:27:42,674 [trainer.py] => Average Accuracy (CNN): 76.03250000000001
2025-11-18 07:27:42,674 [trainer.py] => Average Accuracy (NME): 65.80909090909091
2025-11-18 07:27:42,675 [trainer.py] => All params: 89880260
2025-11-18 07:27:42,676 [trainer.py] => Trainable params: 2516180
2025-11-18 07:27:42,676 [sema.py] => Learning on 120-130
2025-11-18 07:27:42,677 [sema.py] => [DEBUG] Task 12: New data size: 244, Memory Size: 1691, Total Dataset Size: 1935
2025-11-18 07:27:49,643 [sema_block.py] => Adapter 9.3 added at block 9
2025-11-18 07:30:47,251 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.253, Train_accy 93.85, Test_accy 59.85
2025-11-18 07:32:02,779 [trainer.py] => config: exps/sema_ina.json
2025-11-18 07:32:02,780 [trainer.py] => eval: False
2025-11-18 07:32:02,780 [trainer.py] => prefix: reproduce
2025-11-18 07:32:02,780 [trainer.py] => dataset: imageneta
2025-11-18 07:32:02,780 [trainer.py] => memory_size: 2000
2025-11-18 07:32:02,781 [trainer.py] => memory_per_class: None
2025-11-18 07:32:02,781 [trainer.py] => fixed_memory: False
2025-11-18 07:32:02,781 [trainer.py] => shuffle: False
2025-11-18 07:32:02,781 [trainer.py] => init_cls: 10
2025-11-18 07:32:02,781 [trainer.py] => increment: 10
2025-11-18 07:32:02,782 [trainer.py] => model_name: sema
2025-11-18 07:32:02,782 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 07:32:02,782 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 07:32:02,782 [trainer.py] => seed: 1993
2025-11-18 07:32:02,782 [trainer.py] => batch_size: 32
2025-11-18 07:32:02,782 [trainer.py] => weight_decay: 0.0005
2025-11-18 07:32:02,782 [trainer.py] => min_lr: 0
2025-11-18 07:32:02,782 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 07:32:02,782 [trainer.py] => ffn_num: 16
2025-11-18 07:32:02,783 [trainer.py] => optimizer: sgd
2025-11-18 07:32:02,783 [trainer.py] => vpt_type: shallow
2025-11-18 07:32:02,783 [trainer.py] => prompt_token_num: 5
2025-11-18 07:32:02,783 [trainer.py] => func_epoch: 20
2025-11-18 07:32:02,783 [trainer.py] => rd_epoch: 20
2025-11-18 07:32:02,783 [trainer.py] => init_lr: 0.005
2025-11-18 07:32:02,783 [trainer.py] => rd_lr: 0.01
2025-11-18 07:32:02,783 [trainer.py] => rd_dim: 128
2025-11-18 07:32:02,784 [trainer.py] => buffer_size: 500
2025-11-18 07:32:02,784 [trainer.py] => detect_batch_size: 128
2025-11-18 07:32:02,784 [trainer.py] => exp_threshold: 1
2025-11-18 07:32:02,784 [trainer.py] => exp_k_std: 3.0
2025-11-18 07:32:02,784 [trainer.py] => router_attn_dim: 128
2025-11-18 07:32:02,784 [trainer.py] => adapt_start_layer: 9
2025-11-18 07:32:02,784 [trainer.py] => adapt_end_layer: 11
2025-11-18 07:32:02,801 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 07:32:04,051 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 07:32:04,073 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 07:32:04,095 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 07:32:04,118 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 07:32:04,147 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 07:32:04,199 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 07:32:04,233 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 07:32:04,289 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 07:32:04,346 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 07:32:04,404 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 07:32:04,462 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 07:32:04,497 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 07:32:04,991 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 07:32:07,154 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-18 07:32:07,327 [trainer.py] => All params: 89057868
2025-11-18 07:32:07,328 [trainer.py] => Trainable params: 3259212
2025-11-18 07:32:07,334 [sema.py] => Learning on 0-10
2025-11-18 07:33:10,360 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-18 07:34:13,906 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-18 07:34:14,615 [sema.py] => Building rehearsal memory...
2025-11-18 07:34:14,616 [base.py] => Constructing exemplars...(200 per classes)
2025-11-18 07:34:24,409 [sema.py] => Memory size: 660
2025-11-18 07:34:24,410 [trainer.py] => No NME accuracy.
2025-11-18 07:34:24,410 [trainer.py] => CNN: {'total': 92.95, '00-09': 92.95, 'old': 0, 'new': 92.95}
2025-11-18 07:34:24,410 [trainer.py] => CNN top1 curve: [92.95]
2025-11-18 07:34:24,410 [trainer.py] => CNN top5 curve: [99.36]

2025-11-18 07:34:24,411 [trainer.py] => Average Accuracy (CNN): 92.95 

2025-11-18 07:34:24,411 [trainer.py] => All params: 89211668
2025-11-18 07:34:24,412 [trainer.py] => Trainable params: 2516180
2025-11-18 07:34:24,412 [sema.py] => Learning on 10-20
2025-11-18 07:34:24,413 [sema.py] => [DEBUG] Task 1: New data size: 599, Memory Size: 660, Total Dataset Size: 1259
2025-11-18 07:34:24,414 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-18 07:39:49,594 [trainer.py] => config: exps/sema_ina.json
2025-11-18 07:39:49,594 [trainer.py] => eval: False
2025-11-18 07:39:49,595 [trainer.py] => prefix: reproduce
2025-11-18 07:39:49,595 [trainer.py] => dataset: imageneta
2025-11-18 07:39:49,595 [trainer.py] => memory_size: 2000
2025-11-18 07:39:49,595 [trainer.py] => memory_per_class: None
2025-11-18 07:39:49,596 [trainer.py] => fixed_memory: False
2025-11-18 07:39:49,596 [trainer.py] => shuffle: False
2025-11-18 07:39:49,596 [trainer.py] => init_cls: 10
2025-11-18 07:39:49,596 [trainer.py] => increment: 10
2025-11-18 07:39:49,596 [trainer.py] => model_name: sema
2025-11-18 07:39:49,597 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-18 07:39:49,597 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-18 07:39:49,597 [trainer.py] => seed: 1993
2025-11-18 07:39:49,597 [trainer.py] => batch_size: 32
2025-11-18 07:39:49,597 [trainer.py] => weight_decay: 0.0005
2025-11-18 07:39:49,597 [trainer.py] => min_lr: 0
2025-11-18 07:39:49,597 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-18 07:39:49,598 [trainer.py] => ffn_num: 16
2025-11-18 07:39:49,598 [trainer.py] => optimizer: sgd
2025-11-18 07:39:49,598 [trainer.py] => vpt_type: shallow
2025-11-18 07:39:49,598 [trainer.py] => prompt_token_num: 5
2025-11-18 07:39:49,598 [trainer.py] => func_epoch: 20
2025-11-18 07:39:49,598 [trainer.py] => rd_epoch: 20
2025-11-18 07:39:49,598 [trainer.py] => init_lr: 0.005
2025-11-18 07:39:49,598 [trainer.py] => rd_lr: 0.01
2025-11-18 07:39:49,598 [trainer.py] => rd_dim: 128
2025-11-18 07:39:49,598 [trainer.py] => buffer_size: 500
2025-11-18 07:39:49,599 [trainer.py] => detect_batch_size: 128
2025-11-18 07:39:49,599 [trainer.py] => exp_threshold: 1
2025-11-18 07:39:49,599 [trainer.py] => exp_k_std: 3.0
2025-11-18 07:39:49,599 [trainer.py] => router_attn_dim: 128
2025-11-18 07:39:49,599 [trainer.py] => adapt_start_layer: 9
2025-11-18 07:39:49,599 [trainer.py] => adapt_end_layer: 11
2025-11-18 07:39:49,611 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-18 07:39:50,482 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-18 07:39:50,510 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-18 07:39:50,537 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-18 07:39:50,565 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-18 07:39:50,594 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-18 07:39:50,622 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-18 07:39:50,649 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-18 07:39:50,678 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-18 07:39:50,706 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-18 07:39:50,735 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-18 07:39:50,763 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-18 07:39:50,791 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-18 07:39:51,351 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-18 07:39:51,907 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-18 07:39:51,990 [trainer.py] => All params: 89057868
2025-11-18 07:39:51,992 [trainer.py] => Trainable params: 3259212
2025-11-18 07:39:51,994 [sema.py] => Learning on 0-10
2025-11-18 07:40:53,649 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-18 07:41:56,260 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-18 07:41:56,941 [sema.py] => Building rehearsal memory...
2025-11-18 07:41:56,942 [base.py] => Constructing exemplars...(200 per classes)
2025-11-18 07:42:05,696 [sema.py] => Memory size: 660
2025-11-18 07:42:05,696 [trainer.py] => No NME accuracy.
2025-11-18 07:42:05,696 [trainer.py] => CNN: {'total': 92.95, '00-09': 92.95, 'old': 0, 'new': 92.95}
2025-11-18 07:42:05,697 [trainer.py] => CNN top1 curve: [92.95]
2025-11-18 07:42:05,697 [trainer.py] => CNN top5 curve: [99.36]

2025-11-18 07:42:05,697 [trainer.py] => Average Accuracy (CNN): 92.95 

2025-11-18 07:42:05,698 [trainer.py] => All params: 89211668
2025-11-18 07:42:05,699 [trainer.py] => Trainable params: 2516180
2025-11-18 07:42:05,699 [sema.py] => Learning on 10-20
2025-11-18 07:42:05,699 [sema.py] => [DEBUG] Task 1: New data size: 599, Memory Size: 660, Total Dataset Size: 1259
2025-11-18 07:42:05,701 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-18 07:43:58,497 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-18 07:45:50,977 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.266, Train_accy 92.14, Test_accy 86.64
2025-11-18 07:45:53,312 [sema.py] => Building rehearsal memory...
2025-11-18 07:45:53,313 [base.py] => Reducing exemplars...(100 per classes)
2025-11-18 07:45:57,747 [base.py] => Constructing exemplars...(100 per classes)
2025-11-18 07:46:06,001 [sema.py] => Memory size: 1259
2025-11-18 07:46:06,002 [trainer.py] => CNN: {'total': 86.64, '00-09': 85.9, '10-19': 87.42, 'old': 85.9, 'new': 87.42}
2025-11-18 07:46:06,002 [trainer.py] => NME: {'total': 45.28, '00-09': 89.1, '10-19': 0.0, 'old': 89.1, 'new': 0.0}
2025-11-18 07:46:06,002 [trainer.py] => CNN top1 curve: [92.95, 86.64]
2025-11-18 07:46:06,003 [trainer.py] => CNN top5 curve: [99.36, 98.37]
2025-11-18 07:46:06,003 [trainer.py] => NME top1 curve: [45.28]
2025-11-18 07:46:06,003 [trainer.py] => NME top5 curve: [50.81]

2025-11-18 07:46:06,003 [trainer.py] => Average Accuracy (CNN): 89.795
2025-11-18 07:46:06,004 [trainer.py] => Average Accuracy (NME): 45.28
2025-11-18 07:46:06,004 [trainer.py] => All params: 89211668
2025-11-18 07:46:06,005 [trainer.py] => Trainable params: 2516180
2025-11-18 07:46:06,005 [sema.py] => Learning on 20-30
2025-11-18 07:46:06,006 [sema.py] => [DEBUG] Task 2: New data size: 636, Memory Size: 1259, Total Dataset Size: 1895
2025-11-18 07:46:06,007 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-18 07:48:43,420 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-18 07:51:23,664 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.265, Train_accy 92.40, Test_accy 86.35
2025-11-18 07:51:27,030 [sema.py] => Building rehearsal memory...
2025-11-18 07:51:27,031 [base.py] => Reducing exemplars...(66 per classes)
2025-11-18 07:51:35,464 [base.py] => Constructing exemplars...(66 per classes)
2025-11-18 07:51:43,815 [sema.py] => Memory size: 1730
2025-11-18 07:51:43,815 [trainer.py] => CNN: {'total': 86.35, '00-09': 83.33, '10-19': 86.09, '20-29': 89.51, 'old': 84.69, 'new': 89.51}
2025-11-18 07:51:43,815 [trainer.py] => NME: {'total': 58.0, '00-09': 89.74, '10-19': 87.42, '20-29': 0.0, 'old': 88.6, 'new': 0.0}
2025-11-18 07:51:43,815 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35]
2025-11-18 07:51:43,816 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51]
2025-11-18 07:51:43,816 [trainer.py] => NME top1 curve: [45.28, 58.0]
2025-11-18 07:51:43,816 [trainer.py] => NME top5 curve: [50.81, 64.82]

2025-11-18 07:51:43,816 [trainer.py] => Average Accuracy (CNN): 88.64666666666666
2025-11-18 07:51:43,817 [trainer.py] => Average Accuracy (NME): 51.64
2025-11-18 07:51:43,817 [trainer.py] => All params: 89211668
2025-11-18 07:51:43,818 [trainer.py] => Trainable params: 2516180
2025-11-18 07:51:43,818 [sema.py] => Learning on 30-40
2025-11-18 07:51:43,819 [sema.py] => [DEBUG] Task 3: New data size: 361, Memory Size: 1730, Total Dataset Size: 2091
2025-11-18 07:51:43,820 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-18 07:51:54,471 [sema_block.py] => Adapter 9.1 added at block 9
2025-11-18 08:04:09,228 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.204, Train_accy 94.07, Test_accy 80.21
2025-11-18 08:08:20,416 [sema.py] => rd Task 3, Epoch 20/20 => Loss 0.117, Train_accy 91.41, Test_accy 80.21
2025-11-18 08:15:51,903 [sema.py] => Building rehearsal memory...
2025-11-18 08:15:51,904 [base.py] => Reducing exemplars...(50 per classes)
2025-11-18 08:16:02,922 [base.py] => Constructing exemplars...(50 per classes)
2025-11-18 08:16:09,049 [sema.py] => Memory size: 1749
2025-11-18 08:16:09,051 [trainer.py] => CNN: {'total': 80.21, '00-09': 76.92, '10-19': 82.12, '20-29': 85.19, '30-39': 73.91, 'old': 81.45, 'new': 73.91}
2025-11-18 08:16:09,052 [trainer.py] => NME: {'total': 71.12, '00-09': 85.26, '10-19': 84.77, '20-29': 85.19, '30-39': 0.0, 'old': 85.07, 'new': 0.0}
2025-11-18 08:16:09,052 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21]
2025-11-18 08:16:09,053 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79]
2025-11-18 08:16:09,053 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12]
2025-11-18 08:16:09,054 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82]

2025-11-18 08:16:09,054 [trainer.py] => Average Accuracy (CNN): 86.5375
2025-11-18 08:16:09,054 [trainer.py] => Average Accuracy (NME): 58.13333333333333
2025-11-18 08:16:09,055 [trainer.py] => All params: 89434532
2025-11-18 08:16:09,056 [trainer.py] => Trainable params: 2516180
2025-11-18 08:16:09,057 [sema.py] => Learning on 40-50
2025-11-18 08:16:09,058 [sema.py] => [DEBUG] Task 4: New data size: 427, Memory Size: 1749, Total Dataset Size: 2176
2025-11-18 08:16:09,061 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-18 08:16:20,841 [sema_block.py] => Adapter 10.1 added at block 10
2025-11-18 08:30:11,072 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.225, Train_accy 93.52, Test_accy 76.87
2025-11-20 08:43:51,942 [trainer.py] => config: exps/sema_ina.json
2025-11-20 08:43:51,942 [trainer.py] => eval: False
2025-11-20 08:43:51,942 [trainer.py] => prefix: reproduce
2025-11-20 08:43:51,943 [trainer.py] => dataset: imageneta
2025-11-20 08:43:51,943 [trainer.py] => memory_size: 2000
2025-11-20 08:43:51,943 [trainer.py] => memory_per_class: None
2025-11-20 08:43:51,943 [trainer.py] => fixed_memory: False
2025-11-20 08:43:51,944 [trainer.py] => shuffle: False
2025-11-20 08:43:51,944 [trainer.py] => init_cls: 10
2025-11-20 08:43:51,944 [trainer.py] => increment: 10
2025-11-20 08:43:51,944 [trainer.py] => model_name: sema
2025-11-20 08:43:51,944 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-20 08:43:51,945 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-20 08:43:51,945 [trainer.py] => seed: 1993
2025-11-20 08:43:51,945 [trainer.py] => batch_size: 32
2025-11-20 08:43:51,945 [trainer.py] => weight_decay: 0.0005
2025-11-20 08:43:51,945 [trainer.py] => min_lr: 0
2025-11-20 08:43:51,946 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-20 08:43:51,946 [trainer.py] => ffn_num: 16
2025-11-20 08:43:51,946 [trainer.py] => optimizer: sgd
2025-11-20 08:43:51,946 [trainer.py] => vpt_type: shallow
2025-11-20 08:43:51,946 [trainer.py] => prompt_token_num: 5
2025-11-20 08:43:51,946 [trainer.py] => func_epoch: 20
2025-11-20 08:43:51,947 [trainer.py] => rd_epoch: 20
2025-11-20 08:43:51,947 [trainer.py] => init_lr: 0.005
2025-11-20 08:43:51,947 [trainer.py] => rd_lr: 0.01
2025-11-20 08:43:51,947 [trainer.py] => rd_dim: 128
2025-11-20 08:43:51,947 [trainer.py] => buffer_size: 500
2025-11-20 08:43:51,947 [trainer.py] => detect_batch_size: 128
2025-11-20 08:43:51,948 [trainer.py] => exp_threshold: 1
2025-11-20 08:43:51,948 [trainer.py] => exp_k_std: 3.0
2025-11-20 08:43:51,948 [trainer.py] => router_attn_dim: 128
2025-11-20 08:43:51,948 [trainer.py] => adapt_start_layer: 9
2025-11-20 08:43:51,948 [trainer.py] => adapt_end_layer: 11
2025-11-20 08:43:52,021 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-20 08:43:53,833 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-20 08:43:53,862 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-20 08:43:53,892 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-20 08:43:53,921 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-20 08:43:53,949 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-20 08:43:53,977 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-20 08:43:54,004 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-20 08:43:54,033 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-20 08:43:54,061 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-20 08:43:54,092 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-20 08:43:54,121 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-20 08:43:54,150 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-20 08:43:54,718 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-20 08:43:55,648 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-20 08:43:55,837 [trainer.py] => All params: 89057868
2025-11-20 08:43:55,840 [trainer.py] => Trainable params: 3259212
2025-11-20 08:43:55,841 [sema.py] => Learning on 0-10
2025-11-20 08:44:59,923 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-20 08:46:02,558 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-20 08:46:03,261 [sema.py] => Building rehearsal memory...
2025-11-20 08:46:03,262 [base.py] => Constructing exemplars...(200 per classes)
2025-11-20 08:46:12,281 [sema.py] => Memory size: 660
2025-11-20 08:46:12,282 [trainer.py] => No NME accuracy.
2025-11-20 08:46:12,282 [trainer.py] => CNN: {'total': 92.95, '00-09': 92.95, 'old': 0, 'new': 92.95}
2025-11-20 08:46:12,282 [trainer.py] => CNN top1 curve: [92.95]
2025-11-20 08:46:12,282 [trainer.py] => CNN top5 curve: [99.36]

2025-11-20 08:46:12,283 [trainer.py] => Average Accuracy (CNN): 92.95 

2025-11-20 08:46:12,283 [trainer.py] => All params: 89211668
2025-11-20 08:46:12,284 [trainer.py] => Trainable params: 2516180
2025-11-20 08:46:12,284 [sema.py] => Learning on 10-20
2025-11-20 08:46:12,285 [sema.py] => [DEBUG] Task 1: New data size: 599, Memory Size: 660, Total Dataset Size: 1259
2025-11-20 08:46:12,286 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 08:48:01,736 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 08:49:51,211 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.266, Train_accy 92.14, Test_accy 86.64
2025-11-20 08:49:53,600 [sema.py] => Building rehearsal memory...
2025-11-20 08:49:53,601 [base.py] => Reducing exemplars...(100 per classes)
2025-11-20 08:49:58,102 [base.py] => Constructing exemplars...(100 per classes)
2025-11-20 08:50:06,633 [sema.py] => Memory size: 1259
2025-11-20 08:50:06,633 [trainer.py] => CNN: {'total': 86.64, '00-09': 85.9, '10-19': 87.42, 'old': 85.9, 'new': 87.42}
2025-11-20 08:50:06,647 [trainer.py] => NME: {'total': 45.28, '00-09': 89.1, '10-19': 0.0, 'old': 89.1, 'new': 0.0}
2025-11-20 08:50:06,647 [trainer.py] => CNN top1 curve: [92.95, 86.64]
2025-11-20 08:50:06,648 [trainer.py] => CNN top5 curve: [99.36, 98.37]
2025-11-20 08:50:06,648 [trainer.py] => NME top1 curve: [45.28]
2025-11-20 08:50:06,648 [trainer.py] => NME top5 curve: [50.81]

2025-11-20 08:50:06,648 [trainer.py] => Average Accuracy (CNN): 89.795
2025-11-20 08:50:06,648 [trainer.py] => Average Accuracy (NME): 45.28
2025-11-20 08:50:06,649 [trainer.py] => All params: 89211668
2025-11-20 08:50:06,650 [trainer.py] => Trainable params: 2516180
2025-11-20 08:50:06,650 [sema.py] => Learning on 20-30
2025-11-20 08:50:06,651 [sema.py] => [DEBUG] Task 2: New data size: 636, Memory Size: 1259, Total Dataset Size: 1895
2025-11-20 08:50:06,652 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 08:52:50,719 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 08:55:30,644 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.265, Train_accy 92.40, Test_accy 86.35
2025-11-20 08:55:33,916 [sema.py] => Building rehearsal memory...
2025-11-20 08:55:33,917 [base.py] => Reducing exemplars...(66 per classes)
2025-11-20 08:55:42,466 [base.py] => Constructing exemplars...(66 per classes)
2025-11-20 08:55:50,904 [sema.py] => Memory size: 1730
2025-11-20 08:55:50,905 [trainer.py] => CNN: {'total': 86.35, '00-09': 83.33, '10-19': 86.09, '20-29': 89.51, 'old': 84.69, 'new': 89.51}
2025-11-20 08:55:50,905 [trainer.py] => NME: {'total': 58.0, '00-09': 89.74, '10-19': 87.42, '20-29': 0.0, 'old': 88.6, 'new': 0.0}
2025-11-20 08:55:50,905 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35]
2025-11-20 08:55:50,906 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51]
2025-11-20 08:55:50,906 [trainer.py] => NME top1 curve: [45.28, 58.0]
2025-11-20 08:55:50,906 [trainer.py] => NME top5 curve: [50.81, 64.82]

2025-11-20 08:55:50,906 [trainer.py] => Average Accuracy (CNN): 88.64666666666666
2025-11-20 08:55:50,906 [trainer.py] => Average Accuracy (NME): 51.64
2025-11-20 08:55:50,907 [trainer.py] => All params: 89211668
2025-11-20 08:55:50,908 [trainer.py] => Trainable params: 2516180
2025-11-20 08:55:50,908 [sema.py] => Learning on 30-40
2025-11-20 08:55:50,909 [sema.py] => [DEBUG] Task 3: New data size: 361, Memory Size: 1730, Total Dataset Size: 2091
2025-11-20 08:55:50,911 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 08:56:01,175 [sema_block.py] => Adapter 9.1 added at block 9
2025-11-20 09:07:25,858 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.204, Train_accy 94.07, Test_accy 80.21
2025-11-20 09:11:30,657 [sema.py] => rd Task 3, Epoch 20/20 => Loss 0.117, Train_accy 91.41, Test_accy 80.21
2025-11-20 09:18:40,126 [sema.py] => Building rehearsal memory...
2025-11-20 09:18:40,127 [base.py] => Reducing exemplars...(50 per classes)
2025-11-20 09:18:51,272 [base.py] => Constructing exemplars...(50 per classes)
2025-11-20 09:18:56,984 [sema.py] => Memory size: 1749
2025-11-20 09:18:56,985 [trainer.py] => CNN: {'total': 80.21, '00-09': 76.92, '10-19': 82.12, '20-29': 85.19, '30-39': 73.91, 'old': 81.45, 'new': 73.91}
2025-11-20 09:18:56,985 [trainer.py] => NME: {'total': 71.12, '00-09': 85.26, '10-19': 84.77, '20-29': 85.19, '30-39': 0.0, 'old': 85.07, 'new': 0.0}
2025-11-20 09:18:56,986 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21]
2025-11-20 09:18:56,986 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79]
2025-11-20 09:18:56,986 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12]
2025-11-20 09:18:56,986 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82]

2025-11-20 09:18:56,986 [trainer.py] => Average Accuracy (CNN): 86.5375
2025-11-20 09:18:56,987 [trainer.py] => Average Accuracy (NME): 58.13333333333333
2025-11-20 09:18:56,987 [trainer.py] => All params: 89434532
2025-11-20 09:18:56,988 [trainer.py] => Trainable params: 2516180
2025-11-20 09:18:56,988 [sema.py] => Learning on 40-50
2025-11-20 09:18:56,989 [sema.py] => [DEBUG] Task 4: New data size: 427, Memory Size: 1749, Total Dataset Size: 2176
2025-11-20 09:18:56,991 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 09:19:07,712 [sema_block.py] => Adapter 10.1 added at block 10
2025-11-20 09:28:39,687 [trainer.py] => config: exps/sema_ina.json
2025-11-20 09:28:39,687 [trainer.py] => eval: False
2025-11-20 09:28:39,688 [trainer.py] => prefix: reproduce
2025-11-20 09:28:39,688 [trainer.py] => dataset: imageneta
2025-11-20 09:28:39,688 [trainer.py] => memory_size: 2000
2025-11-20 09:28:39,688 [trainer.py] => memory_per_class: None
2025-11-20 09:28:39,688 [trainer.py] => fixed_memory: False
2025-11-20 09:28:39,688 [trainer.py] => shuffle: False
2025-11-20 09:28:39,689 [trainer.py] => init_cls: 10
2025-11-20 09:28:39,689 [trainer.py] => increment: 10
2025-11-20 09:28:39,689 [trainer.py] => model_name: sema
2025-11-20 09:28:39,689 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-20 09:28:39,689 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-20 09:28:39,689 [trainer.py] => seed: 1993
2025-11-20 09:28:39,690 [trainer.py] => batch_size: 32
2025-11-20 09:28:39,690 [trainer.py] => weight_decay: 0.0005
2025-11-20 09:28:39,690 [trainer.py] => min_lr: 0
2025-11-20 09:28:39,690 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-20 09:28:39,690 [trainer.py] => ffn_num: 16
2025-11-20 09:28:39,690 [trainer.py] => optimizer: sgd
2025-11-20 09:28:39,691 [trainer.py] => vpt_type: shallow
2025-11-20 09:28:39,691 [trainer.py] => prompt_token_num: 5
2025-11-20 09:28:39,691 [trainer.py] => func_epoch: 20
2025-11-20 09:28:39,691 [trainer.py] => rd_epoch: 20
2025-11-20 09:28:39,691 [trainer.py] => init_lr: 0.005
2025-11-20 09:28:39,691 [trainer.py] => rd_lr: 0.01
2025-11-20 09:28:39,691 [trainer.py] => rd_dim: 128
2025-11-20 09:28:39,692 [trainer.py] => buffer_size: 500
2025-11-20 09:28:39,692 [trainer.py] => detect_batch_size: 128
2025-11-20 09:28:39,692 [trainer.py] => exp_threshold: 4
2025-11-20 09:28:39,692 [trainer.py] => exp_k_std: 5.0
2025-11-20 09:28:39,692 [trainer.py] => router_attn_dim: 128
2025-11-20 09:28:39,692 [trainer.py] => adapt_start_layer: 9
2025-11-20 09:28:39,692 [trainer.py] => adapt_end_layer: 11
2025-11-20 09:28:39,712 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-20 09:28:41,373 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-20 09:28:41,432 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-20 09:28:41,464 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-20 09:28:41,501 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-20 09:28:41,539 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-20 09:28:41,576 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-20 09:28:41,612 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-20 09:28:41,648 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-20 09:28:41,684 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-20 09:28:41,724 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-20 09:28:41,758 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-20 09:28:41,789 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-20 09:28:42,423 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-20 09:28:43,177 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-20 09:28:43,378 [trainer.py] => All params: 89057868
2025-11-20 09:28:43,381 [trainer.py] => Trainable params: 3259212
2025-11-20 09:28:43,383 [sema.py] => Learning on 0-10
2025-11-20 09:29:46,125 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.223, Train_accy 91.97, Test_accy 92.95
2025-11-20 09:30:50,600 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.271, Train_accy 91.97, Test_accy 92.95
2025-11-20 09:30:51,325 [sema.py] => Building rehearsal memory...
2025-11-20 09:30:51,326 [base.py] => Constructing exemplars...(200 per classes)
2025-11-20 09:31:00,537 [sema.py] => Memory size: 660
2025-11-20 09:31:00,538 [trainer.py] => No NME accuracy.
2025-11-20 09:31:00,539 [trainer.py] => CNN: {'total': 92.95, '00-09': 92.95, 'old': 0, 'new': 92.95}
2025-11-20 09:31:00,539 [trainer.py] => CNN top1 curve: [92.95]
2025-11-20 09:31:00,539 [trainer.py] => CNN top5 curve: [99.36]

2025-11-20 09:31:00,539 [trainer.py] => Average Accuracy (CNN): 92.95 

2025-11-20 09:31:00,540 [trainer.py] => All params: 89211668
2025-11-20 09:31:00,541 [trainer.py] => Trainable params: 2516180
2025-11-20 09:31:00,541 [sema.py] => Learning on 10-20
2025-11-20 09:31:00,541 [sema.py] => [DEBUG] Task 1: New data size: 599, Memory Size: 660, Total Dataset Size: 1259
2025-11-20 09:31:00,543 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 09:32:46,347 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 09:34:38,036 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.266, Train_accy 92.14, Test_accy 86.64
2025-11-20 09:34:40,440 [sema.py] => Building rehearsal memory...
2025-11-20 09:34:40,441 [base.py] => Reducing exemplars...(100 per classes)
2025-11-20 09:34:45,086 [base.py] => Constructing exemplars...(100 per classes)
2025-11-20 09:34:53,749 [sema.py] => Memory size: 1259
2025-11-20 09:34:53,749 [trainer.py] => CNN: {'total': 86.64, '00-09': 85.9, '10-19': 87.42, 'old': 85.9, 'new': 87.42}
2025-11-20 09:34:53,750 [trainer.py] => NME: {'total': 45.28, '00-09': 89.1, '10-19': 0.0, 'old': 89.1, 'new': 0.0}
2025-11-20 09:34:53,750 [trainer.py] => CNN top1 curve: [92.95, 86.64]
2025-11-20 09:34:53,751 [trainer.py] => CNN top5 curve: [99.36, 98.37]
2025-11-20 09:34:53,751 [trainer.py] => NME top1 curve: [45.28]
2025-11-20 09:34:53,751 [trainer.py] => NME top5 curve: [50.81]

2025-11-20 09:34:53,751 [trainer.py] => Average Accuracy (CNN): 89.795
2025-11-20 09:34:53,752 [trainer.py] => Average Accuracy (NME): 45.28
2025-11-20 09:34:53,752 [trainer.py] => All params: 89211668
2025-11-20 09:34:53,753 [trainer.py] => Trainable params: 2516180
2025-11-20 09:34:53,753 [sema.py] => Learning on 20-30
2025-11-20 09:34:53,754 [sema.py] => [DEBUG] Task 2: New data size: 636, Memory Size: 1259, Total Dataset Size: 1895
2025-11-20 09:34:53,755 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 09:37:33,941 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 09:40:19,279 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.265, Train_accy 92.40, Test_accy 86.35
2025-11-20 09:40:22,806 [sema.py] => Building rehearsal memory...
2025-11-20 09:40:22,807 [base.py] => Reducing exemplars...(66 per classes)
2025-11-20 09:40:31,784 [base.py] => Constructing exemplars...(66 per classes)
2025-11-20 09:40:40,545 [sema.py] => Memory size: 1730
2025-11-20 09:40:40,546 [trainer.py] => CNN: {'total': 86.35, '00-09': 83.33, '10-19': 86.09, '20-29': 89.51, 'old': 84.69, 'new': 89.51}
2025-11-20 09:40:40,546 [trainer.py] => NME: {'total': 58.0, '00-09': 89.74, '10-19': 87.42, '20-29': 0.0, 'old': 88.6, 'new': 0.0}
2025-11-20 09:40:40,547 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35]
2025-11-20 09:40:40,547 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51]
2025-11-20 09:40:40,547 [trainer.py] => NME top1 curve: [45.28, 58.0]
2025-11-20 09:40:40,547 [trainer.py] => NME top5 curve: [50.81, 64.82]

2025-11-20 09:40:40,548 [trainer.py] => Average Accuracy (CNN): 88.64666666666666
2025-11-20 09:40:40,548 [trainer.py] => Average Accuracy (NME): 51.64
2025-11-20 09:40:40,548 [trainer.py] => All params: 89211668
2025-11-20 09:40:40,549 [trainer.py] => Trainable params: 2516180
2025-11-20 09:40:40,549 [sema.py] => Learning on 30-40
2025-11-20 09:40:40,550 [sema.py] => [DEBUG] Task 3: New data size: 361, Memory Size: 1730, Total Dataset Size: 2091
2025-11-20 09:40:40,551 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 09:40:51,089 [sema_block.py] => Adapter 9.1 added at block 9
2025-11-20 09:52:31,093 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.204, Train_accy 94.07, Test_accy 80.21
2025-11-20 09:56:41,013 [sema.py] => rd Task 3, Epoch 20/20 => Loss 0.117, Train_accy 91.41, Test_accy 80.21
2025-11-20 10:03:45,214 [sema.py] => Building rehearsal memory...
2025-11-20 10:03:45,215 [base.py] => Reducing exemplars...(50 per classes)
2025-11-20 10:03:56,665 [base.py] => Constructing exemplars...(50 per classes)
2025-11-20 10:04:02,543 [sema.py] => Memory size: 1749
2025-11-20 10:04:02,544 [trainer.py] => CNN: {'total': 80.21, '00-09': 76.92, '10-19': 82.12, '20-29': 85.19, '30-39': 73.91, 'old': 81.45, 'new': 73.91}
2025-11-20 10:04:02,544 [trainer.py] => NME: {'total': 71.12, '00-09': 85.26, '10-19': 84.77, '20-29': 85.19, '30-39': 0.0, 'old': 85.07, 'new': 0.0}
2025-11-20 10:04:02,545 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21]
2025-11-20 10:04:02,545 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79]
2025-11-20 10:04:02,545 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12]
2025-11-20 10:04:02,545 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82]

2025-11-20 10:04:02,545 [trainer.py] => Average Accuracy (CNN): 86.5375
2025-11-20 10:04:02,545 [trainer.py] => Average Accuracy (NME): 58.13333333333333
2025-11-20 10:04:02,546 [trainer.py] => All params: 89434532
2025-11-20 10:04:02,546 [trainer.py] => Trainable params: 2516180
2025-11-20 10:04:02,547 [sema.py] => Learning on 40-50
2025-11-20 10:04:02,548 [sema.py] => [DEBUG] Task 4: New data size: 427, Memory Size: 1749, Total Dataset Size: 2176
2025-11-20 10:04:02,551 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 10:04:13,264 [sema_block.py] => Adapter 10.1 added at block 10
2025-11-20 10:17:51,272 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.225, Train_accy 93.52, Test_accy 76.87
2025-11-20 10:22:41,143 [sema.py] => rd Task 4, Epoch 20/20 => Loss 0.211, Train_accy 92.04, Test_accy 76.87
2025-11-20 10:22:47,310 [sema_block.py] => Adapter 9.2 added at block 9
2025-11-20 10:50:03,056 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.200, Train_accy 94.76, Test_accy 75.07
2025-11-20 10:58:23,087 [sema.py] => rd Task 4, Epoch 20/20 => Loss 0.122, Train_accy 95.08, Test_accy 75.07
2025-11-20 11:04:28,821 [sema.py] => Building rehearsal memory...
2025-11-20 11:04:28,822 [base.py] => Reducing exemplars...(40 per classes)
2025-11-20 11:04:41,540 [base.py] => Constructing exemplars...(40 per classes)
2025-11-20 11:04:48,131 [sema.py] => Memory size: 1760
2025-11-20 11:04:48,134 [trainer.py] => CNN: {'total': 75.07, '00-09': 75.64, '10-19': 78.81, '20-29': 82.1, '30-39': 60.87, '40-49': 70.64, 'old': 75.94, 'new': 70.64}
2025-11-20 11:04:48,134 [trainer.py] => NME: {'total': 67.91, '00-09': 79.49, '10-19': 83.44, '20-29': 82.72, '30-39': 77.17, '40-49': 0.0, 'old': 81.11, 'new': 0.0}
2025-11-20 11:04:48,134 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07]
2025-11-20 11:04:48,134 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18]
2025-11-20 11:04:48,135 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91]
2025-11-20 11:04:48,135 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04]

2025-11-20 11:04:48,135 [trainer.py] => Average Accuracy (CNN): 84.244
2025-11-20 11:04:48,135 [trainer.py] => Average Accuracy (NME): 60.5775
2025-11-20 11:04:48,136 [trainer.py] => All params: 89880260
2025-11-20 11:04:48,137 [trainer.py] => Trainable params: 2516180
2025-11-20 11:04:48,137 [sema.py] => Learning on 50-60
2025-11-20 11:04:48,144 [sema.py] => [DEBUG] Task 5: New data size: 566, Memory Size: 1760, Total Dataset Size: 2326
2025-11-20 11:04:48,151 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 11:04:57,744 [sema_block.py] => Adapter 9.3 added at block 9
2025-11-20 11:18:00,264 [sema.py] => func Task 5, Epoch 20/20 => Loss 0.246, Train_accy 93.16, Test_accy 70.82
2025-11-20 11:23:29,442 [sema.py] => rd Task 5, Epoch 20/20 => Loss 0.127, Train_accy 88.52, Test_accy 70.82
2025-11-20 11:30:43,201 [sema.py] => Building rehearsal memory...
2025-11-20 11:30:43,201 [base.py] => Reducing exemplars...(33 per classes)
2025-11-20 11:30:57,743 [base.py] => Constructing exemplars...(33 per classes)
2025-11-20 11:31:04,947 [sema.py] => Memory size: 1792
2025-11-20 11:31:04,947 [trainer.py] => CNN: {'total': 70.82, '00-09': 72.44, '10-19': 71.52, '20-29': 74.07, '30-39': 60.87, '40-49': 72.48, '50-59': 69.8, 'old': 71.04, 'new': 69.8}
2025-11-20 11:31:04,948 [trainer.py] => NME: {'total': 65.08, '00-09': 82.69, '10-19': 79.47, '20-29': 82.1, '30-39': 78.26, '40-49': 72.48, '50-59': 0.0, 'old': 79.55, 'new': 0.0}
2025-11-20 11:31:04,948 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82]
2025-11-20 11:31:04,948 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82]
2025-11-20 11:31:04,948 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08]
2025-11-20 11:31:04,949 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51]

2025-11-20 11:31:04,949 [trainer.py] => Average Accuracy (CNN): 82.00666666666666
2025-11-20 11:31:04,949 [trainer.py] => Average Accuracy (NME): 61.477999999999994
2025-11-20 11:31:04,950 [trainer.py] => All params: 90103124
2025-11-20 11:31:04,951 [trainer.py] => Trainable params: 2516180
2025-11-20 11:31:04,951 [sema.py] => Learning on 60-70
2025-11-20 11:31:04,954 [sema.py] => [DEBUG] Task 6: New data size: 450, Memory Size: 1792, Total Dataset Size: 2242
2025-11-20 11:31:04,958 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 11:34:07,122 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 11:38:04,450 [sema.py] => func Task 6, Epoch 20/20 => Loss 0.230, Train_accy 93.76, Test_accy 68.43
2025-11-20 11:38:11,378 [sema.py] => Building rehearsal memory...
2025-11-20 11:38:11,379 [base.py] => Reducing exemplars...(28 per classes)
2025-11-20 11:38:27,519 [base.py] => Constructing exemplars...(28 per classes)
2025-11-20 11:38:33,869 [sema.py] => Memory size: 1807
2025-11-20 11:38:33,870 [trainer.py] => CNN: {'total': 68.43, '00-09': 66.03, '10-19': 69.54, '20-29': 69.14, '30-39': 63.04, '40-49': 71.56, '50-59': 59.73, '60-69': 80.47, 'old': 66.54, 'new': 80.47}
2025-11-20 11:38:33,870 [trainer.py] => NME: {'total': 66.42, '00-09': 78.21, '10-19': 80.79, '20-29': 79.01, '30-39': 76.09, '40-49': 71.56, '50-59': 73.15, '60-69': 0.0, 'old': 76.8, 'new': 0.0}
2025-11-20 11:38:33,870 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43]
2025-11-20 11:38:33,870 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5]
2025-11-20 11:38:33,870 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42]
2025-11-20 11:38:33,871 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84]

2025-11-20 11:38:33,871 [trainer.py] => Average Accuracy (CNN): 80.06714285714285
2025-11-20 11:38:33,871 [trainer.py] => Average Accuracy (NME): 62.30166666666667
2025-11-20 11:38:33,872 [trainer.py] => All params: 90103124
2025-11-20 11:38:33,873 [trainer.py] => Trainable params: 2516180
2025-11-20 11:38:33,873 [sema.py] => Learning on 70-80
2025-11-20 11:38:33,876 [sema.py] => [DEBUG] Task 7: New data size: 146, Memory Size: 1807, Total Dataset Size: 1953
2025-11-20 11:38:33,878 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 11:38:43,446 [sema_block.py] => Adapter 9.4 added at block 9
2025-11-20 11:50:27,925 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.179, Train_accy 95.39, Test_accy 64.33
2025-11-20 11:53:43,916 [sema.py] => rd Task 7, Epoch 20/20 => Loss 0.112, Train_accy 97.95, Test_accy 64.33
2025-11-20 11:54:07,444 [sema_block.py] => Adapter 10.2 added at block 10
2025-11-20 11:56:57,589 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.142, Train_accy 96.26, Test_accy 64.33
2025-11-20 11:58:43,200 [sema.py] => rd Task 7, Epoch 20/20 => Loss 0.208, Train_accy 93.84, Test_accy 64.33
2025-11-20 11:59:01,387 [sema.py] => Building rehearsal memory...
2025-11-20 11:59:01,388 [base.py] => Reducing exemplars...(25 per classes)
2025-11-20 11:59:19,497 [base.py] => Constructing exemplars...(25 per classes)
2025-11-20 11:59:23,652 [sema.py] => Memory size: 1772
2025-11-20 11:59:23,652 [trainer.py] => CNN: {'total': 64.33, '00-09': 67.95, '10-19': 64.24, '20-29': 60.49, '30-39': 59.78, '40-49': 61.47, '50-59': 60.4, '60-69': 75.78, '70-79': 62.16, 'old': 64.41, 'new': 62.16}
2025-11-20 11:59:23,653 [trainer.py] => NME: {'total': 71.54, '00-09': 74.36, '10-19': 78.81, '20-29': 76.54, '30-39': 76.09, '40-49': 66.97, '50-59': 71.81, '60-69': 74.22, '70-79': 0.0, 'old': 74.34, 'new': 0.0}
2025-11-20 11:59:23,653 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33]
2025-11-20 11:59:23,653 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5]
2025-11-20 11:59:23,654 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54]
2025-11-20 11:59:23,654 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65]

2025-11-20 11:59:23,654 [trainer.py] => Average Accuracy (CNN): 78.10000000000001
2025-11-20 11:59:23,654 [trainer.py] => Average Accuracy (NME): 63.621428571428574
2025-11-20 11:59:23,655 [trainer.py] => All params: 90548852
2025-11-20 11:59:23,656 [trainer.py] => Trainable params: 2516180
2025-11-20 11:59:23,656 [sema.py] => Learning on 80-90
2025-11-20 11:59:23,659 [sema.py] => [DEBUG] Task 8: New data size: 210, Memory Size: 1772, Total Dataset Size: 1982
2025-11-20 11:59:23,662 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 12:01:40,212 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 13:40:21,403 [sema.py] => func Task 8, Epoch 20/20 => Loss 0.139, Train_accy 96.27, Test_accy 62.20
2025-11-20 13:41:28,990 [sema.py] => Building rehearsal memory...
2025-11-20 13:41:28,991 [base.py] => Reducing exemplars...(22 per classes)
2025-11-20 13:41:56,174 [base.py] => Constructing exemplars...(22 per classes)
2025-11-20 13:42:02,590 [sema.py] => Memory size: 1767
2025-11-20 13:42:02,591 [trainer.py] => CNN: {'total': 62.2, '00-09': 59.62, '10-19': 68.21, '20-29': 58.64, '30-39': 63.04, '40-49': 60.55, '50-59': 55.7, '60-69': 73.44, '70-79': 54.05, '80-89': 62.26, 'old': 62.2, 'new': 62.26}
2025-11-20 13:42:02,591 [trainer.py] => NME: {'total': 69.05, '00-09': 73.72, '10-19': 76.82, '20-29': 74.69, '30-39': 73.91, '40-49': 61.47, '50-59': 73.15, '60-69': 75.0, '70-79': 64.86, '80-89': 0.0, 'old': 72.76, 'new': 0.0}
2025-11-20 13:42:02,591 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2]
2025-11-20 13:42:02,591 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61]
2025-11-20 13:42:02,591 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05]
2025-11-20 13:42:02,592 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27]

2025-11-20 13:42:02,592 [trainer.py] => Average Accuracy (CNN): 76.33333333333334
2025-11-20 13:42:02,592 [trainer.py] => Average Accuracy (NME): 64.3
2025-11-20 13:42:02,593 [trainer.py] => All params: 90548852
2025-11-20 13:42:02,593 [trainer.py] => Trainable params: 2516180
2025-11-20 13:42:02,594 [sema.py] => Learning on 90-100
2025-11-20 13:42:02,598 [sema.py] => [DEBUG] Task 9: New data size: 216, Memory Size: 1767, Total Dataset Size: 1983
2025-11-20 13:42:02,603 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 13:44:11,704 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 15:21:42,668 [sema.py] => func Task 9, Epoch 20/20 => Loss 0.118, Train_accy 97.18, Test_accy 58.20
2025-11-20 15:22:54,048 [sema.py] => Building rehearsal memory...
2025-11-20 15:22:54,048 [base.py] => Reducing exemplars...(20 per classes)
2025-11-20 15:23:16,109 [base.py] => Constructing exemplars...(20 per classes)
2025-11-20 15:23:22,624 [sema.py] => Memory size: 1776
2025-11-20 15:23:22,624 [trainer.py] => CNN: {'total': 58.2, '00-09': 55.13, '10-19': 60.93, '20-29': 54.94, '30-39': 57.61, '40-49': 61.47, '50-59': 55.7, '60-69': 68.75, '70-79': 51.35, '80-89': 39.62, '90-99': 69.39, 'old': 57.67, 'new': 69.39}
2025-11-20 15:23:22,625 [trainer.py] => NME: {'total': 66.3, '00-09': 71.15, '10-19': 71.52, '20-29': 73.46, '30-39': 68.48, '40-49': 58.72, '50-59': 71.14, '60-69': 69.53, '70-79': 54.05, '80-89': 75.47, '90-99': 0.0, 'old': 69.43, 'new': 0.0}
2025-11-20 15:23:22,625 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2]
2025-11-20 15:23:22,626 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76]
2025-11-20 15:23:22,626 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3]
2025-11-20 15:23:22,626 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02]

2025-11-20 15:23:22,626 [trainer.py] => Average Accuracy (CNN): 74.52000000000001
2025-11-20 15:23:22,627 [trainer.py] => Average Accuracy (NME): 64.52222222222221
2025-11-20 15:23:22,627 [trainer.py] => All params: 90548852
2025-11-20 15:23:22,628 [trainer.py] => Trainable params: 2516180
2025-11-20 15:23:22,628 [sema.py] => Learning on 100-110
2025-11-20 15:23:22,629 [sema.py] => [DEBUG] Task 10: New data size: 134, Memory Size: 1776, Total Dataset Size: 1910
2025-11-20 15:23:22,636 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 15:25:29,210 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 16:54:56,852 [sema.py] => func Task 10, Epoch 20/20 => Loss 0.101, Train_accy 97.49, Test_accy 55.83
2025-11-20 16:56:10,275 [sema.py] => Building rehearsal memory...
2025-11-20 16:56:10,275 [base.py] => Reducing exemplars...(18 per classes)
2025-11-20 16:56:33,894 [base.py] => Constructing exemplars...(18 per classes)
2025-11-20 16:56:38,660 [sema.py] => Memory size: 1744
2025-11-20 16:56:38,661 [trainer.py] => CNN: {'total': 55.83, '00-09': 60.26, '10-19': 62.25, '20-29': 55.56, '30-39': 57.61, '40-49': 55.05, '50-59': 50.34, '60-69': 64.84, '70-79': 45.95, '80-89': 43.4, '90-99': 53.06, '100-109': 32.43, 'old': 56.63, 'new': 32.43}
2025-11-20 16:56:38,661 [trainer.py] => NME: {'total': 65.45, '00-09': 71.15, '10-19': 73.51, '20-29': 74.07, '30-39': 70.65, '40-49': 55.96, '50-59': 67.11, '60-69': 69.53, '70-79': 54.05, '80-89': 60.38, '90-99': 53.06, '100-109': 0.0, 'old': 67.68, 'new': 0.0}
2025-11-20 16:56:38,662 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83]
2025-11-20 16:56:38,662 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34]
2025-11-20 16:56:38,662 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45]
2025-11-20 16:56:38,663 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49]

2025-11-20 16:56:38,663 [trainer.py] => Average Accuracy (CNN): 72.82090909090911
2025-11-20 16:56:38,663 [trainer.py] => Average Accuracy (NME): 64.615
2025-11-20 16:56:38,664 [trainer.py] => All params: 90548852
2025-11-20 16:56:38,665 [trainer.py] => Trainable params: 2516180
2025-11-20 16:56:38,665 [sema.py] => Learning on 110-120
2025-11-20 16:56:38,669 [sema.py] => [DEBUG] Task 11: New data size: 126, Memory Size: 1744, Total Dataset Size: 1870
2025-11-20 16:56:38,673 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 16:58:38,567 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 18:20:07,130 [sema.py] => func Task 11, Epoch 20/20 => Loss 0.079, Train_accy 98.02, Test_accy 51.69
2025-11-20 18:21:22,754 [sema.py] => Building rehearsal memory...
2025-11-20 18:21:22,755 [base.py] => Reducing exemplars...(16 per classes)
2025-11-20 18:21:47,678 [base.py] => Constructing exemplars...(16 per classes)
2025-11-20 18:21:51,915 [sema.py] => Memory size: 1691
2025-11-20 18:21:51,916 [trainer.py] => CNN: {'total': 51.69, '00-09': 57.05, '10-19': 54.97, '20-29': 54.32, '30-39': 54.35, '40-49': 50.46, '50-59': 46.31, '60-69': 65.62, '70-79': 43.24, '80-89': 35.85, '90-99': 44.9, '100-109': 27.03, '110-119': 38.24, 'old': 52.09, 'new': 38.24}
2025-11-20 18:21:51,916 [trainer.py] => NME: {'total': 61.45, '00-09': 67.95, '10-19': 72.19, '20-29': 70.37, '30-39': 61.96, '40-49': 53.21, '50-59': 63.76, '60-69': 67.19, '70-79': 45.95, '80-89': 60.38, '90-99': 44.9, '100-109': 40.54, '110-119': 0.0, 'old': 63.31, 'new': 0.0}
2025-11-20 18:21:51,916 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69]
2025-11-20 18:21:51,916 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45]
2025-11-20 18:21:51,917 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45]
2025-11-20 18:21:51,917 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79]

2025-11-20 18:21:51,917 [trainer.py] => Average Accuracy (CNN): 71.06000000000002
2025-11-20 18:21:51,917 [trainer.py] => Average Accuracy (NME): 64.32727272727273
2025-11-20 18:21:51,918 [trainer.py] => All params: 90548852
2025-11-20 18:21:51,919 [trainer.py] => Trainable params: 2516180
2025-11-20 18:21:51,919 [sema.py] => Learning on 120-130
2025-11-20 18:21:51,923 [sema.py] => [DEBUG] Task 12: New data size: 244, Memory Size: 1691, Total Dataset Size: 1935
2025-11-20 18:21:51,926 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 18:23:08,058 [sema_block.py] => Adapter 10.3 added at block 10
2025-11-20 18:56:57,320 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.087, Train_accy 97.83, Test_accy 49.96
2025-11-20 19:15:25,261 [sema.py] => rd Task 12, Epoch 20/20 => Loss 0.214, Train_accy 98.36, Test_accy 49.96
2025-11-20 19:16:30,754 [sema_block.py] => Adapter 9.5 added at block 9
2025-11-20 19:41:17,586 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.053, Train_accy 98.66, Test_accy 50.04
2025-11-20 19:52:10,869 [sema.py] => rd Task 12, Epoch 20/20 => Loss 0.113, Train_accy 98.36, Test_accy 50.04
2025-11-20 19:58:29,803 [sema.py] => Building rehearsal memory...
2025-11-20 19:58:29,804 [base.py] => Reducing exemplars...(15 per classes)
2025-11-20 19:58:57,062 [base.py] => Constructing exemplars...(15 per classes)
2025-11-20 19:59:03,457 [sema.py] => Memory size: 1739
2025-11-20 19:59:03,458 [trainer.py] => CNN: {'total': 50.04, '00-09': 53.85, '10-19': 55.63, '20-29': 51.23, '30-39': 52.17, '40-49': 55.96, '50-59': 48.32, '60-69': 57.03, '70-79': 43.24, '80-89': 35.85, '90-99': 44.9, '100-109': 21.62, '110-119': 41.18, '120-129': 41.07, 'old': 50.48, 'new': 41.07}
2025-11-20 19:59:03,458 [trainer.py] => NME: {'total': 59.6, '00-09': 67.95, '10-19': 72.85, '20-29': 66.67, '30-39': 66.3, '40-49': 52.29, '50-59': 65.77, '60-69': 66.41, '70-79': 51.35, '80-89': 54.72, '90-99': 38.78, '100-109': 37.84, '110-119': 50.0, '120-129': 0.0, 'old': 62.49, 'new': 0.0}
2025-11-20 19:59:03,458 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04]
2025-11-20 19:59:03,458 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87]
2025-11-20 19:59:03,458 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6]
2025-11-20 19:59:03,458 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26]

2025-11-20 19:59:03,459 [trainer.py] => Average Accuracy (CNN): 69.44307692307694
2025-11-20 19:59:03,459 [trainer.py] => Average Accuracy (NME): 63.93333333333334
2025-11-20 19:59:03,460 [trainer.py] => All params: 90994580
2025-11-20 19:59:03,460 [trainer.py] => Trainable params: 2516180
2025-11-20 19:59:03,461 [sema.py] => Learning on 130-140
2025-11-20 19:59:03,463 [sema.py] => [DEBUG] Task 13: New data size: 113, Memory Size: 1739, Total Dataset Size: 1852
2025-11-20 19:59:03,465 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 19:59:18,340 [sema_block.py] => Adapter 9.6 added at block 9
2025-11-20 21:23:19,504 [sema.py] => func Task 13, Epoch 20/20 => Loss 0.061, Train_accy 98.43, Test_accy 46.45
2025-11-20 21:44:00,052 [sema.py] => rd Task 13, Epoch 20/20 => Loss 0.112, Train_accy 95.58, Test_accy 46.45
2025-11-20 21:44:38,044 [sema_block.py] => Adapter 10.4 added at block 10
2025-11-20 21:47:55,860 [sema.py] => func Task 13, Epoch 20/20 => Loss 0.054, Train_accy 98.49, Test_accy 47.74
2025-11-20 21:50:06,036 [sema.py] => rd Task 13, Epoch 20/20 => Loss 0.203, Train_accy 95.58, Test_accy 47.74
2025-11-20 21:55:27,820 [sema.py] => Building rehearsal memory...
2025-11-20 21:55:27,820 [base.py] => Reducing exemplars...(14 per classes)
2025-11-20 21:56:01,484 [base.py] => Constructing exemplars...(14 per classes)
2025-11-20 21:56:07,354 [sema.py] => Memory size: 1749
2025-11-20 21:56:07,355 [trainer.py] => CNN: {'total': 47.74, '00-09': 50.64, '10-19': 51.66, '20-29': 53.09, '30-39': 54.35, '40-49': 51.38, '50-59': 47.65, '60-69': 61.72, '70-79': 45.95, '80-89': 32.08, '90-99': 30.61, '100-109': 10.81, '110-119': 32.35, '120-129': 39.29, '130-139': 25.93, 'old': 48.23, 'new': 25.93}
2025-11-20 21:56:07,355 [trainer.py] => NME: {'total': 58.39, '00-09': 65.38, '10-19': 74.17, '20-29': 67.28, '30-39': 64.13, '40-49': 53.21, '50-59': 63.76, '60-69': 68.75, '70-79': 51.35, '80-89': 45.28, '90-99': 40.82, '100-109': 27.03, '110-119': 38.24, '120-129': 26.79, '130-139': 0.0, 'old': 59.69, 'new': 0.0}
2025-11-20 21:56:07,355 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04, 47.74]
2025-11-20 21:56:07,356 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87, 70.16]
2025-11-20 21:56:07,356 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6, 58.39]
2025-11-20 21:56:07,356 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26, 81.85]

2025-11-20 21:56:07,356 [trainer.py] => Average Accuracy (CNN): 67.89285714285715
2025-11-20 21:56:07,356 [trainer.py] => Average Accuracy (NME): 63.50692307692308
2025-11-20 21:56:07,357 [trainer.py] => All params: 91440308
2025-11-20 21:56:07,358 [trainer.py] => Trainable params: 2516180
2025-11-20 21:56:07,359 [sema.py] => Learning on 140-150
2025-11-20 21:56:07,362 [sema.py] => [DEBUG] Task 14: New data size: 168, Memory Size: 1749, Total Dataset Size: 1917
2025-11-20 21:56:07,366 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 21:58:26,895 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-20 23:42:59,960 [sema.py] => func Task 14, Epoch 20/20 => Loss 0.070, Train_accy 98.33, Test_accy 43.14
2025-11-20 23:44:21,027 [sema.py] => Building rehearsal memory...
2025-11-20 23:44:21,028 [base.py] => Reducing exemplars...(13 per classes)
2025-11-20 23:44:52,437 [base.py] => Constructing exemplars...(13 per classes)
2025-11-20 23:44:57,424 [sema.py] => Memory size: 1756
2025-11-20 23:44:57,424 [trainer.py] => CNN: {'total': 43.14, '00-09': 48.72, '10-19': 47.68, '20-29': 48.15, '30-39': 51.09, '40-49': 47.71, '50-59': 42.28, '60-69': 56.25, '70-79': 32.43, '80-89': 30.19, '90-99': 24.49, '100-109': 5.41, '110-119': 32.35, '120-129': 26.79, '130-139': 29.63, '140-149': 41.18, 'old': 43.23, 'new': 41.18}
2025-11-20 23:44:57,424 [trainer.py] => NME: {'total': 54.38, '00-09': 59.62, '10-19': 71.52, '20-29': 64.81, '30-39': 59.78, '40-49': 52.29, '50-59': 62.42, '60-69': 67.19, '70-79': 51.35, '80-89': 43.4, '90-99': 32.65, '100-109': 27.03, '110-119': 38.24, '120-129': 28.57, '130-139': 29.63, '140-149': 0.0, 'old': 56.61, 'new': 0.0}
2025-11-20 23:44:57,425 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04, 47.74, 43.14]
2025-11-20 23:44:57,425 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87, 70.16, 65.45]
2025-11-20 23:44:57,425 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6, 58.39, 54.38]
2025-11-20 23:44:57,425 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26, 81.85, 78.93]

2025-11-20 23:44:57,425 [trainer.py] => Average Accuracy (CNN): 66.24266666666668
2025-11-20 23:44:57,426 [trainer.py] => Average Accuracy (NME): 62.855000000000004
2025-11-20 23:44:57,426 [trainer.py] => All params: 91440308
2025-11-20 23:44:57,427 [trainer.py] => Trainable params: 2516180
2025-11-20 23:44:57,428 [sema.py] => Learning on 150-160
2025-11-20 23:44:57,431 [sema.py] => [DEBUG] Task 15: New data size: 149, Memory Size: 1756, Total Dataset Size: 1905
2025-11-20 23:44:57,434 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-20 23:47:14,013 [sema_block.py] => Adapter 9.7 added at block 9
2025-11-21 01:44:41,853 [sema.py] => func Task 15, Epoch 20/20 => Loss 0.060, Train_accy 98.48, Test_accy 42.94
2025-11-21 02:32:17,023 [sema.py] => rd Task 15, Epoch 20/20 => Loss 0.116, Train_accy 97.32, Test_accy 42.94
2025-11-21 02:32:43,130 [sema_block.py] => Adapter 10.5 added at block 10
2025-11-21 03:33:08,268 [sema.py] => func Task 15, Epoch 20/20 => Loss 0.052, Train_accy 99.00, Test_accy 42.34
2025-11-21 04:01:48,745 [sema.py] => rd Task 15, Epoch 20/20 => Loss 0.206, Train_accy 100.00, Test_accy 42.34
2025-11-21 04:03:44,259 [sema.py] => Building rehearsal memory...
2025-11-21 04:03:44,259 [base.py] => Reducing exemplars...(12 per classes)
2025-11-21 04:04:17,779 [base.py] => Constructing exemplars...(12 per classes)
2025-11-21 04:04:22,423 [sema.py] => Memory size: 1747
2025-11-21 04:04:22,424 [trainer.py] => CNN: {'total': 42.34, '00-09': 46.15, '10-19': 50.33, '20-29': 48.15, '30-39': 52.17, '40-49': 45.87, '50-59': 41.61, '60-69': 54.69, '70-79': 21.62, '80-89': 26.42, '90-99': 28.57, '100-109': 10.81, '110-119': 23.53, '120-129': 26.79, '130-139': 22.22, '140-149': 29.41, '150-159': 61.76, 'old': 41.83, 'new': 61.76}
2025-11-21 04:04:22,424 [trainer.py] => NME: {'total': 53.06, '00-09': 57.69, '10-19': 70.86, '20-29': 68.52, '30-39': 57.61, '40-49': 50.46, '50-59': 59.73, '60-69': 66.41, '70-79': 51.35, '80-89': 41.51, '90-99': 24.49, '100-109': 21.62, '110-119': 38.24, '120-129': 26.79, '130-139': 25.93, '140-149': 33.33, '150-159': 0.0, 'old': 54.45, 'new': 0.0}
2025-11-21 04:04:22,424 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04, 47.74, 43.14, 42.34]
2025-11-21 04:04:22,424 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87, 70.16, 65.45, 66.11]
2025-11-21 04:04:22,425 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6, 58.39, 54.38, 53.06]
2025-11-21 04:04:22,425 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26, 81.85, 78.93, 77.21]

2025-11-21 04:04:22,425 [trainer.py] => Average Accuracy (CNN): 64.74875000000002
2025-11-21 04:04:22,425 [trainer.py] => Average Accuracy (NME): 62.202
2025-11-21 04:04:22,426 [trainer.py] => All params: 91886036
2025-11-21 04:04:22,427 [trainer.py] => Trainable params: 2516180
2025-11-21 04:04:22,427 [sema.py] => Learning on 160-170
2025-11-21 04:04:22,431 [sema.py] => [DEBUG] Task 16: New data size: 213, Memory Size: 1747, Total Dataset Size: 1960
2025-11-21 04:04:22,434 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-21 04:05:12,705 [sema_block.py] => Adapter 10.6 added at block 10
2025-11-21 07:48:10,735 [sema.py] => func Task 16, Epoch 20/20 => Loss 0.055, Train_accy 98.78, Test_accy 39.05
2025-11-21 08:19:56,241 [sema.py] => rd Task 16, Epoch 20/20 => Loss 0.217, Train_accy 99.06, Test_accy 39.05
2025-11-21 08:25:07,868 [sema.py] => Building rehearsal memory...
2025-11-21 08:25:07,869 [base.py] => Reducing exemplars...(11 per classes)
2025-11-21 08:25:42,520 [base.py] => Constructing exemplars...(11 per classes)
2025-11-21 08:25:47,096 [sema.py] => Memory size: 1729
2025-11-21 08:25:47,098 [trainer.py] => CNN: {'total': 39.05, '00-09': 48.08, '10-19': 47.02, '20-29': 46.3, '30-39': 46.74, '40-49': 40.37, '50-59': 40.94, '60-69': 51.56, '70-79': 24.32, '80-89': 18.87, '90-99': 22.45, '100-109': 5.41, '110-119': 17.65, '120-129': 19.64, '130-139': 7.41, '140-149': 23.53, '150-159': 44.12, '160-169': 48.0, 'old': 38.72, 'new': 48.0}
2025-11-21 08:25:47,099 [trainer.py] => NME: {'total': 50.84, '00-09': 57.05, '10-19': 66.89, '20-29': 66.67, '30-39': 54.35, '40-49': 51.38, '50-59': 60.4, '60-69': 64.84, '70-79': 48.65, '80-89': 37.74, '90-99': 24.49, '100-109': 24.32, '110-119': 32.35, '120-129': 23.21, '130-139': 25.93, '140-149': 31.37, '150-159': 47.06, '160-169': 0.0, 'old': 52.75, 'new': 0.0}
2025-11-21 08:25:47,099 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04, 47.74, 43.14, 42.34, 39.05]
2025-11-21 08:25:47,099 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87, 70.16, 65.45, 66.11, 63.2]
2025-11-21 08:25:47,099 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6, 58.39, 54.38, 53.06, 50.84]
2025-11-21 08:25:47,100 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26, 81.85, 78.93, 77.21, 75.93]

2025-11-21 08:25:47,100 [trainer.py] => Average Accuracy (CNN): 63.23705882352942
2025-11-21 08:25:47,100 [trainer.py] => Average Accuracy (NME): 61.491875
2025-11-21 08:25:47,101 [trainer.py] => All params: 92108900
2025-11-21 08:25:47,102 [trainer.py] => Trainable params: 2516180
2025-11-21 08:25:47,103 [sema.py] => Learning on 170-180
2025-11-21 08:25:47,105 [sema.py] => [DEBUG] Task 17: New data size: 185, Memory Size: 1729, Total Dataset Size: 1914
2025-11-21 08:25:47,112 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-21 08:28:01,770 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-21 09:40:49,743 [sema.py] => func Task 17, Epoch 20/20 => Loss 0.064, Train_accy 98.33, Test_accy 38.09
2025-11-21 09:41:02,611 [sema.py] => Building rehearsal memory...
2025-11-21 09:41:02,612 [base.py] => Reducing exemplars...(11 per classes)
2025-11-21 09:41:38,709 [base.py] => Constructing exemplars...(11 per classes)
2025-11-21 09:41:44,560 [sema.py] => Memory size: 1825
2025-11-21 09:41:44,561 [trainer.py] => CNN: {'total': 38.09, '00-09': 41.67, '10-19': 50.33, '20-29': 43.21, '30-39': 50.0, '40-49': 44.95, '50-59': 41.61, '60-69': 53.91, '70-79': 21.62, '80-89': 18.87, '90-99': 26.53, '100-109': 5.41, '110-119': 17.65, '120-129': 19.64, '130-139': 11.11, '140-149': 17.65, '150-159': 38.24, '160-169': 28.0, '170-179': 32.5, 'old': 38.25, 'new': 32.5}
2025-11-21 09:41:44,562 [trainer.py] => NME: {'total': 48.48, '00-09': 53.85, '10-19': 68.21, '20-29': 62.35, '30-39': 55.43, '40-49': 44.95, '50-59': 61.07, '60-69': 58.59, '70-79': 48.65, '80-89': 33.96, '90-99': 24.49, '100-109': 21.62, '110-119': 29.41, '120-129': 19.64, '130-139': 29.63, '140-149': 31.37, '150-159': 47.06, '160-169': 30.0, '170-179': 0.0, 'old': 49.89, 'new': 0.0}
2025-11-21 09:41:44,562 [trainer.py] => CNN top1 curve: [92.95, 86.64, 86.35, 80.21, 75.07, 70.82, 68.43, 64.33, 62.2, 58.2, 55.83, 51.69, 50.04, 47.74, 43.14, 42.34, 39.05, 38.09]
2025-11-21 09:41:44,562 [trainer.py] => CNN top5 curve: [99.36, 98.37, 98.51, 96.79, 94.18, 91.82, 90.5, 87.5, 83.61, 80.76, 79.34, 75.45, 73.87, 70.16, 65.45, 66.11, 63.2, 61.91]
2025-11-21 09:41:44,562 [trainer.py] => NME top1 curve: [45.28, 58.0, 71.12, 67.91, 65.08, 66.42, 71.54, 69.05, 66.3, 65.45, 61.45, 59.6, 58.39, 54.38, 53.06, 50.84, 48.48]
2025-11-21 09:41:44,563 [trainer.py] => NME top5 curve: [50.81, 64.82, 81.82, 81.04, 78.51, 81.84, 90.65, 87.27, 87.02, 85.49, 84.79, 83.26, 81.85, 78.93, 77.21, 75.93, 73.99]

2025-11-21 09:41:44,563 [trainer.py] => Average Accuracy (CNN): 61.84
2025-11-21 09:41:44,563 [trainer.py] => Average Accuracy (NME): 60.72647058823529
2025-11-21 09:41:44,564 [trainer.py] => All params: 92108900
2025-11-21 09:41:44,565 [trainer.py] => Trainable params: 2516180
2025-11-21 09:41:44,565 [sema.py] => Learning on 180-190
2025-11-21 09:41:44,569 [sema.py] => [DEBUG] Task 18: New data size: 222, Memory Size: 1825, Total Dataset Size: 2047
2025-11-21 09:41:44,575 [sema.py] => Unfreezing all the adapters and routers for rehearsal...
2025-11-21 09:44:14,447 [sema.py] => No new adapters created fine tuning existing adapters...
2025-11-21 11:37:53,840 [trainer.py] => config: exps/sema_ina.json
2025-11-21 11:37:53,840 [trainer.py] => eval: False
2025-11-21 11:37:53,841 [trainer.py] => prefix: reproduce
2025-11-21 11:37:53,841 [trainer.py] => dataset: imageneta
2025-11-21 11:37:53,841 [trainer.py] => memory_size: 0
2025-11-21 11:37:53,841 [trainer.py] => memory_per_class: 0
2025-11-21 11:37:53,841 [trainer.py] => fixed_memory: False
2025-11-21 11:37:53,841 [trainer.py] => shuffle: False
2025-11-21 11:37:53,841 [trainer.py] => init_cls: 10
2025-11-21 11:37:53,842 [trainer.py] => increment: 10
2025-11-21 11:37:53,842 [trainer.py] => model_name: sema
2025-11-21 11:37:53,842 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-21 11:37:53,842 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-21 11:37:53,842 [trainer.py] => seed: 1993
2025-11-21 11:37:53,842 [trainer.py] => batch_size: 32
2025-11-21 11:37:53,842 [trainer.py] => weight_decay: 0.0005
2025-11-21 11:37:53,842 [trainer.py] => min_lr: 0
2025-11-21 11:37:53,842 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-21 11:37:53,843 [trainer.py] => ffn_num: 16
2025-11-21 11:37:53,843 [trainer.py] => optimizer: sgd
2025-11-21 11:37:53,843 [trainer.py] => vpt_type: shallow
2025-11-21 11:37:53,843 [trainer.py] => prompt_token_num: 5
2025-11-21 11:37:53,843 [trainer.py] => func_epoch: 20
2025-11-21 11:37:53,843 [trainer.py] => rd_epoch: 20
2025-11-21 11:37:53,843 [trainer.py] => init_lr: 0.005
2025-11-21 11:37:53,843 [trainer.py] => rd_lr: 0.01
2025-11-21 11:37:53,843 [trainer.py] => rd_dim: 128
2025-11-21 11:37:53,843 [trainer.py] => buffer_size: 500
2025-11-21 11:37:53,844 [trainer.py] => detect_batch_size: 128
2025-11-21 11:37:53,844 [trainer.py] => exp_threshold: 4
2025-11-21 11:37:53,844 [trainer.py] => exp_k_std: 5.0
2025-11-21 11:37:53,844 [trainer.py] => router_attn_dim: 128
2025-11-21 11:37:53,844 [trainer.py] => adapt_start_layer: 9
2025-11-21 11:37:53,844 [trainer.py] => adapt_end_layer: 11
2025-11-21 11:37:53,917 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-21 11:37:55,282 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-21 11:37:55,327 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-21 11:37:55,365 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-21 11:37:55,411 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-21 11:37:55,457 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-21 11:37:55,501 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-21 11:37:55,540 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-21 11:37:55,572 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-21 11:37:55,605 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-21 11:37:55,652 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-21 11:37:55,797 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-21 11:37:55,862 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-21 11:37:56,628 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-21 11:37:56,887 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-21 11:37:56,997 [trainer.py] => All params: 89067096
2025-11-21 11:37:56,999 [trainer.py] => Trainable params: 3268440
2025-11-21 11:37:57,001 [sema.py] => Learning on 0-10
2025-11-25 11:28:22,269 [trainer.py] => config: exps/sema_ina.json
2025-11-25 11:28:22,269 [trainer.py] => eval: False
2025-11-25 11:28:22,269 [trainer.py] => prefix: reproduce
2025-11-25 11:28:22,270 [trainer.py] => dataset: imageneta
2025-11-25 11:28:22,270 [trainer.py] => imbalance_ratio: 1.0
2025-11-25 11:28:22,270 [trainer.py] => memory_size: 0
2025-11-25 11:28:22,271 [trainer.py] => memory_per_class: 0
2025-11-25 11:28:22,271 [trainer.py] => fixed_memory: False
2025-11-25 11:28:22,271 [trainer.py] => shuffle: False
2025-11-25 11:28:22,271 [trainer.py] => init_cls: 10
2025-11-25 11:28:22,271 [trainer.py] => increment: 10
2025-11-25 11:28:22,272 [trainer.py] => model_name: sema
2025-11-25 11:28:22,272 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-25 11:28:22,272 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-25 11:28:22,272 [trainer.py] => seed: 1993
2025-11-25 11:28:22,273 [trainer.py] => batch_size: 32
2025-11-25 11:28:22,273 [trainer.py] => weight_decay: 0.0005
2025-11-25 11:28:22,273 [trainer.py] => min_lr: 0
2025-11-25 11:28:22,273 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-25 11:28:22,273 [trainer.py] => ffn_num: 16
2025-11-25 11:28:22,274 [trainer.py] => optimizer: sgd
2025-11-25 11:28:22,274 [trainer.py] => vpt_type: shallow
2025-11-25 11:28:22,274 [trainer.py] => prompt_token_num: 5
2025-11-25 11:28:22,274 [trainer.py] => func_epoch: 20
2025-11-25 11:28:22,275 [trainer.py] => rd_epoch: 20
2025-11-25 11:28:22,275 [trainer.py] => init_lr: 0.005
2025-11-25 11:28:22,275 [trainer.py] => rd_lr: 0.01
2025-11-25 11:28:22,275 [trainer.py] => rd_dim: 128
2025-11-25 11:28:22,276 [trainer.py] => buffer_size: 500
2025-11-25 11:28:22,276 [trainer.py] => detect_batch_size: 128
2025-11-25 11:28:22,276 [trainer.py] => exp_threshold: 4
2025-11-25 11:28:22,276 [trainer.py] => exp_k_std: 5.0
2025-11-25 11:28:22,277 [trainer.py] => router_attn_dim: 128
2025-11-25 11:28:22,277 [trainer.py] => adapt_start_layer: 9
2025-11-25 11:28:22,277 [trainer.py] => adapt_end_layer: 11
2025-11-25 11:28:22,359 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-25 11:28:23,358 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-25 11:28:23,385 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-25 11:28:23,413 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-25 11:28:23,441 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-25 11:28:23,468 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-25 11:28:23,496 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-25 11:28:23,523 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-25 11:28:23,550 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-25 11:28:23,577 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-25 11:28:23,607 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-25 11:28:23,636 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-25 11:28:23,664 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-25 11:28:24,202 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-25 11:28:24,667 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-25 11:28:24,784 [trainer.py] => All params: 89067096
2025-11-25 11:28:24,788 [trainer.py] => Trainable params: 3268440
2025-11-25 11:28:24,790 [sema.py] => Learning on 0-10
2025-11-25 11:29:27,175 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.240, Train_accy 92.58, Test_accy 86.54
2025-11-25 11:30:29,373 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.253, Train_accy 0.00, Test_accy 86.54
2025-11-25 11:30:29,374 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:30:31,574 [sema.py] => Prototype replacement complete.
2025-11-25 11:30:32,280 [sema.py] => Caching old model for distillation...
2025-11-25 11:30:32,303 [trainer.py] => No NME accuracy.
2025-11-25 11:30:32,304 [trainer.py] => CNN: {'total': 89.1, '00-09': 89.1, 'old': 0, 'new': 89.1}
2025-11-25 11:30:32,304 [trainer.py] => CNN top1 curve: [89.1]
2025-11-25 11:30:32,304 [trainer.py] => CNN top5 curve: [99.36]

2025-11-25 11:30:32,305 [trainer.py] => Average Accuracy (CNN): 89.1 

2025-11-25 11:30:32,305 [trainer.py] => All params: 89220896
2025-11-25 11:30:32,306 [trainer.py] => Trainable params: 2525408
2025-11-25 11:30:32,306 [sema.py] => Learning on 10-20
2025-11-25 11:31:43,112 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.334, Train_accy 92.32, Test_accy 70.03
2025-11-25 11:31:43,113 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:31:45,144 [sema.py] => Prototype replacement complete.
2025-11-25 11:31:46,305 [sema.py] => Caching old model for distillation...
2025-11-25 11:31:46,327 [trainer.py] => No NME accuracy.
2025-11-25 11:31:46,328 [trainer.py] => CNN: {'total': 85.67, '00-09': 87.18, '10-19': 84.11, 'old': 87.18, 'new': 84.11}
2025-11-25 11:31:46,328 [trainer.py] => CNN top1 curve: [89.1, 85.67]
2025-11-25 11:31:46,328 [trainer.py] => CNN top5 curve: [99.36, 99.67]

2025-11-25 11:31:46,328 [trainer.py] => Average Accuracy (CNN): 87.38499999999999 

2025-11-25 11:31:46,329 [trainer.py] => All params: 89220896
2025-11-25 11:31:46,329 [trainer.py] => Trainable params: 2525408
2025-11-25 11:31:46,330 [sema.py] => Learning on 20-30
2025-11-25 11:33:11,116 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.293, Train_accy 94.50, Test_accy 67.59
2025-11-25 11:33:11,116 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:33:13,326 [sema.py] => Prototype replacement complete.
2025-11-25 11:33:15,059 [sema.py] => Caching old model for distillation...
2025-11-25 11:33:15,082 [trainer.py] => No NME accuracy.
2025-11-25 11:33:15,082 [trainer.py] => CNN: {'total': 82.3, '00-09': 83.33, '10-19': 80.79, '20-29': 82.72, 'old': 82.08, 'new': 82.72}
2025-11-25 11:33:15,082 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3]
2025-11-25 11:33:15,083 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51]

2025-11-25 11:33:15,083 [trainer.py] => Average Accuracy (CNN): 85.69 

2025-11-25 11:33:15,083 [trainer.py] => All params: 89220896
2025-11-25 11:33:15,084 [trainer.py] => Trainable params: 2525408
2025-11-25 11:33:15,084 [sema.py] => Learning on 30-40
2025-11-25 11:34:31,804 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.249, Train_accy 96.12, Test_accy 73.80
2025-11-25 11:34:31,804 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:34:33,223 [sema.py] => Prototype replacement complete.
2025-11-25 11:34:35,309 [sema.py] => Caching old model for distillation...
2025-11-25 11:34:35,329 [trainer.py] => No NME accuracy.
2025-11-25 11:34:35,330 [trainer.py] => CNN: {'total': 79.86, '00-09': 81.41, '10-19': 78.15, '20-29': 80.86, '30-39': 78.26, 'old': 80.17, 'new': 78.26}
2025-11-25 11:34:35,330 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86]
2025-11-25 11:34:35,330 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22]

2025-11-25 11:34:35,330 [trainer.py] => Average Accuracy (CNN): 84.2325 

2025-11-25 11:34:35,331 [trainer.py] => All params: 89220896
2025-11-25 11:34:35,331 [trainer.py] => Trainable params: 2525408
2025-11-25 11:34:35,332 [sema.py] => Learning on 40-50
2025-11-25 11:36:03,911 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.320, Train_accy 93.21, Test_accy 70.90
2025-11-25 11:36:03,911 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:36:05,438 [sema.py] => Prototype replacement complete.
2025-11-25 11:36:07,610 [sema.py] => Caching old model for distillation...
2025-11-25 11:36:07,629 [trainer.py] => No NME accuracy.
2025-11-25 11:36:07,629 [trainer.py] => CNN: {'total': 78.51, '00-09': 80.77, '10-19': 76.82, '20-29': 80.86, '30-39': 75.0, '40-49': 77.06, 'old': 78.79, 'new': 77.06}
2025-11-25 11:36:07,629 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51]
2025-11-25 11:36:07,630 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46]

2025-11-25 11:36:07,630 [trainer.py] => Average Accuracy (CNN): 83.088 

2025-11-25 11:36:07,630 [trainer.py] => All params: 89220896
2025-11-25 11:36:07,631 [trainer.py] => Trainable params: 2525408
2025-11-25 11:36:07,631 [sema.py] => Learning on 50-60
2025-11-25 11:37:49,063 [sema.py] => func Task 5, Epoch 20/20 => Loss 0.424, Train_accy 90.11, Test_accy 66.79
2025-11-25 11:37:49,064 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:37:50,893 [sema.py] => Prototype replacement complete.
2025-11-25 11:37:53,508 [sema.py] => Caching old model for distillation...
2025-11-25 11:37:53,529 [trainer.py] => No NME accuracy.
2025-11-25 11:37:53,530 [trainer.py] => CNN: {'total': 76.19, '00-09': 80.77, '10-19': 74.83, '20-29': 80.25, '30-39': 75.0, '40-49': 75.23, '50-59': 69.8, 'old': 77.61, 'new': 69.8}
2025-11-25 11:37:53,530 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19]
2025-11-25 11:37:53,531 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73]

2025-11-25 11:37:53,531 [trainer.py] => Average Accuracy (CNN): 81.93833333333333 

2025-11-25 11:37:53,532 [trainer.py] => All params: 89220896
2025-11-25 11:37:53,532 [trainer.py] => Trainable params: 2525408
2025-11-25 11:37:53,533 [sema.py] => Learning on 60-70
2025-11-25 11:39:34,684 [sema.py] => func Task 6, Epoch 20/20 => Loss 0.444, Train_accy 92.00, Test_accy 67.37
2025-11-25 11:39:34,685 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:39:36,294 [sema.py] => Prototype replacement complete.
2025-11-25 11:39:39,220 [sema.py] => Caching old model for distillation...
2025-11-25 11:39:39,239 [trainer.py] => No NME accuracy.
2025-11-25 11:39:39,239 [trainer.py] => CNN: {'total': 74.45, '00-09': 80.13, '10-19': 73.51, '20-29': 79.63, '30-39': 73.91, '40-49': 70.64, '50-59': 69.13, '60-69': 71.88, 'old': 74.85, 'new': 71.88}
2025-11-25 11:39:39,239 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45]
2025-11-25 11:39:39,239 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19]

2025-11-25 11:39:39,239 [trainer.py] => Average Accuracy (CNN): 80.86857142857143 

2025-11-25 11:39:39,240 [trainer.py] => All params: 89220896
2025-11-25 11:39:39,240 [trainer.py] => Trainable params: 2525408
2025-11-25 11:39:39,241 [sema.py] => Learning on 70-80
2025-11-25 11:40:59,100 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.287, Train_accy 95.89, Test_accy 72.05
2025-11-25 11:40:59,101 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:40:59,771 [sema.py] => Prototype replacement complete.
2025-11-25 11:41:02,705 [sema.py] => Caching old model for distillation...
2025-11-25 11:41:02,723 [trainer.py] => No NME accuracy.
2025-11-25 11:41:02,724 [trainer.py] => CNN: {'total': 73.48, '00-09': 79.49, '10-19': 72.85, '20-29': 79.63, '30-39': 73.91, '40-49': 67.89, '50-59': 69.13, '60-69': 70.31, '70-79': 67.57, 'old': 73.71, 'new': 67.57}
2025-11-25 11:41:02,724 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48]
2025-11-25 11:41:02,725 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7]

2025-11-25 11:41:02,725 [trainer.py] => Average Accuracy (CNN): 79.94500000000001 

2025-11-25 11:41:02,725 [trainer.py] => All params: 89220896
2025-11-25 11:41:02,726 [trainer.py] => Trainable params: 2525408
2025-11-25 11:41:02,727 [sema.py] => Learning on 80-90
2025-11-25 11:42:29,899 [sema.py] => func Task 8, Epoch 20/20 => Loss 0.360, Train_accy 94.76, Test_accy 72.03
2025-11-25 11:42:29,900 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:42:30,746 [sema.py] => Prototype replacement complete.
2025-11-25 11:42:34,062 [sema.py] => Caching old model for distillation...
2025-11-25 11:42:34,082 [trainer.py] => No NME accuracy.
2025-11-25 11:42:34,082 [trainer.py] => CNN: {'total': 73.19, '00-09': 79.49, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 66.97, '50-59': 68.46, '60-69': 70.31, '70-79': 64.86, '80-89': 84.91, 'old': 72.56, 'new': 84.91}
2025-11-25 11:42:34,083 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19]
2025-11-25 11:42:34,083 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35]

2025-11-25 11:42:34,083 [trainer.py] => Average Accuracy (CNN): 79.19444444444444 

2025-11-25 11:42:34,084 [trainer.py] => All params: 89220896
2025-11-25 11:42:34,084 [trainer.py] => Trainable params: 2525408
2025-11-25 11:42:34,085 [sema.py] => Learning on 90-100
2025-11-25 11:44:14,582 [sema.py] => func Task 9, Epoch 20/20 => Loss 0.322, Train_accy 93.98, Test_accy 70.44
2025-11-25 11:44:14,583 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:44:15,482 [sema.py] => Prototype replacement complete.
2025-11-25 11:44:19,497 [sema.py] => Caching old model for distillation...
2025-11-25 11:44:19,517 [trainer.py] => No NME accuracy.
2025-11-25 11:44:19,517 [trainer.py] => CNN: {'total': 71.64, '00-09': 78.85, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 66.97, '50-59': 68.46, '60-69': 70.31, '70-79': 62.16, '80-89': 77.36, '90-99': 51.02, 'old': 72.61, 'new': 51.02}
2025-11-25 11:44:19,518 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64]
2025-11-25 11:44:19,518 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63]

2025-11-25 11:44:19,518 [trainer.py] => Average Accuracy (CNN): 78.439 

2025-11-25 11:44:19,518 [trainer.py] => All params: 89220896
2025-11-25 11:44:19,519 [trainer.py] => Trainable params: 2525408
2025-11-25 11:44:19,519 [sema.py] => Learning on 100-110
2025-11-25 11:45:55,460 [sema.py] => func Task 10, Epoch 20/20 => Loss 0.268, Train_accy 97.01, Test_accy 69.28
2025-11-25 11:45:55,460 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:45:56,083 [sema.py] => Prototype replacement complete.
2025-11-25 11:46:01,170 [sema.py] => Caching old model for distillation...
2025-11-25 11:46:01,190 [trainer.py] => No NME accuracy.
2025-11-25 11:46:01,191 [trainer.py] => CNN: {'total': 70.17, '00-09': 78.85, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 66.06, '50-59': 67.79, '60-69': 70.31, '70-79': 62.16, '80-89': 69.81, '90-99': 51.02, '100-109': 43.24, 'old': 71.09, 'new': 43.24}
2025-11-25 11:46:01,191 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17]
2025-11-25 11:46:01,191 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45]

2025-11-25 11:46:01,192 [trainer.py] => Average Accuracy (CNN): 77.68727272727273 

2025-11-25 11:46:01,193 [trainer.py] => All params: 89220896
2025-11-25 11:46:01,193 [trainer.py] => Trainable params: 2525408
2025-11-25 11:46:01,194 [sema.py] => Learning on 110-120
2025-11-25 11:47:51,280 [sema.py] => func Task 11, Epoch 20/20 => Loss 0.217, Train_accy 96.03, Test_accy 68.11
2025-11-25 11:47:51,280 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:47:51,902 [sema.py] => Prototype replacement complete.
2025-11-25 11:47:57,729 [sema.py] => Caching old model for distillation...
2025-11-25 11:47:57,764 [trainer.py] => No NME accuracy.
2025-11-25 11:47:57,765 [trainer.py] => CNN: {'total': 69.4, '00-09': 78.21, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 66.06, '50-59': 67.79, '60-69': 70.31, '70-79': 62.16, '80-89': 66.04, '90-99': 46.94, '100-109': 40.54, '110-119': 61.76, 'old': 69.63, 'new': 61.76}
2025-11-25 11:47:57,765 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4]
2025-11-25 11:47:57,765 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67]

2025-11-25 11:47:57,765 [trainer.py] => Average Accuracy (CNN): 76.99666666666666 

2025-11-25 11:47:57,766 [trainer.py] => All params: 89220896
2025-11-25 11:47:57,767 [trainer.py] => Trainable params: 2525408
2025-11-25 11:47:57,767 [sema.py] => Learning on 120-130
2025-11-25 11:50:00,761 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.271, Train_accy 94.67, Test_accy 66.53
2025-11-25 11:50:00,762 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:50:01,813 [sema.py] => Prototype replacement complete.
2025-11-25 11:50:06,096 [sema.py] => Caching old model for distillation...
2025-11-25 11:50:06,118 [trainer.py] => No NME accuracy.
2025-11-25 11:50:06,118 [trainer.py] => CNN: {'total': 67.02, '00-09': 78.21, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 59.46, '80-89': 60.38, '90-99': 44.9, '100-109': 32.43, '110-119': 55.88, '120-129': 39.29, 'old': 68.37, 'new': 39.29}
2025-11-25 11:50:06,118 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02]
2025-11-25 11:50:06,118 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28]

2025-11-25 11:50:06,118 [trainer.py] => Average Accuracy (CNN): 76.22923076923077 

2025-11-25 11:50:06,119 [trainer.py] => All params: 89220896
2025-11-25 11:50:06,120 [trainer.py] => Trainable params: 2525408
2025-11-25 11:50:06,120 [sema.py] => Learning on 130-140
2025-11-25 11:51:48,652 [sema.py] => func Task 13, Epoch 20/20 => Loss 0.235, Train_accy 96.46, Test_accy 65.65
2025-11-25 11:51:48,652 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:51:49,210 [sema.py] => Prototype replacement complete.
2025-11-25 11:51:53,709 [sema.py] => Caching old model for distillation...
2025-11-25 11:51:53,729 [trainer.py] => No NME accuracy.
2025-11-25 11:51:53,729 [trainer.py] => CNN: {'total': 66.21, '00-09': 78.21, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 59.46, '80-89': 58.49, '90-99': 42.86, '100-109': 32.43, '110-119': 52.94, '120-129': 39.29, '130-139': 40.74, 'old': 66.78, 'new': 40.74}
2025-11-25 11:51:53,730 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21]
2025-11-25 11:51:53,730 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06]

2025-11-25 11:51:53,731 [trainer.py] => Average Accuracy (CNN): 75.51357142857141 

2025-11-25 11:51:53,731 [trainer.py] => All params: 89220896
2025-11-25 11:51:53,732 [trainer.py] => Trainable params: 2525408
2025-11-25 11:51:53,732 [sema.py] => Learning on 140-150
2025-11-25 11:54:12,622 [sema.py] => func Task 14, Epoch 20/20 => Loss 0.267, Train_accy 97.02, Test_accy 63.67
2025-11-25 11:54:12,622 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:54:14,097 [sema.py] => Prototype replacement complete.
2025-11-25 11:54:18,929 [sema.py] => Caching old model for distillation...
2025-11-25 11:54:18,950 [trainer.py] => No NME accuracy.
2025-11-25 11:54:18,951 [trainer.py] => CNN: {'total': 65.07, '00-09': 78.21, '10-19': 72.85, '20-29': 78.4, '30-39': 69.57, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 59.46, '80-89': 54.72, '90-99': 40.82, '100-109': 32.43, '110-119': 50.0, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, 'old': 65.65, 'new': 50.98}
2025-11-25 11:54:18,951 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07]
2025-11-25 11:54:18,951 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91]

2025-11-25 11:54:18,952 [trainer.py] => Average Accuracy (CNN): 74.81733333333332 

2025-11-25 11:54:18,952 [trainer.py] => All params: 89220896
2025-11-25 11:54:18,953 [trainer.py] => Trainable params: 2525408
2025-11-25 11:54:18,954 [sema.py] => Learning on 150-160
2025-11-25 11:56:33,046 [sema.py] => func Task 15, Epoch 20/20 => Loss 0.235, Train_accy 96.64, Test_accy 63.55
2025-11-25 11:56:33,047 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:56:33,745 [sema.py] => Prototype replacement complete.
2025-11-25 11:56:37,848 [sema.py] => Caching old model for distillation...
2025-11-25 11:56:37,866 [trainer.py] => No NME accuracy.
2025-11-25 11:56:37,866 [trainer.py] => CNN: {'total': 64.6, '00-09': 78.21, '10-19': 72.19, '20-29': 78.4, '30-39': 69.57, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 59.46, '80-89': 54.72, '90-99': 40.82, '100-109': 32.43, '110-119': 50.0, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, '150-159': 50.0, 'old': 64.99, 'new': 50.0}
2025-11-25 11:56:37,866 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07, 64.6]
2025-11-25 11:56:37,866 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91, 86.19]

2025-11-25 11:56:37,867 [trainer.py] => Average Accuracy (CNN): 74.17874999999998 

2025-11-25 11:56:37,867 [trainer.py] => All params: 89220896
2025-11-25 11:56:37,868 [trainer.py] => Trainable params: 2525408
2025-11-25 11:56:37,868 [sema.py] => Learning on 160-170
2025-11-25 11:58:47,443 [sema.py] => func Task 16, Epoch 20/20 => Loss 0.264, Train_accy 96.71, Test_accy 62.18
2025-11-25 11:58:47,443 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 11:58:48,384 [sema.py] => Prototype replacement complete.
2025-11-25 11:58:52,657 [sema.py] => Caching old model for distillation...
2025-11-25 11:58:52,676 [trainer.py] => No NME accuracy.
2025-11-25 11:58:52,677 [trainer.py] => CNN: {'total': 63.13, '00-09': 78.21, '10-19': 70.86, '20-29': 78.4, '30-39': 69.57, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 56.76, '80-89': 52.83, '90-99': 36.73, '100-109': 29.73, '110-119': 38.24, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, '150-159': 50.0, '160-169': 46.0, 'old': 63.77, 'new': 46.0}
2025-11-25 11:58:52,677 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07, 64.6, 63.13]
2025-11-25 11:58:52,677 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91, 86.19, 85.24]

2025-11-25 11:58:52,678 [trainer.py] => Average Accuracy (CNN): 73.52882352941175 

2025-11-25 11:58:52,679 [trainer.py] => All params: 89220896
2025-11-25 11:58:52,679 [trainer.py] => Trainable params: 2525408
2025-11-25 11:58:52,680 [sema.py] => Learning on 170-180
2025-11-25 12:00:56,466 [sema.py] => func Task 17, Epoch 20/20 => Loss 0.273, Train_accy 94.05, Test_accy 61.20
2025-11-25 12:00:56,466 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:00:57,238 [sema.py] => Prototype replacement complete.
2025-11-25 12:01:02,210 [sema.py] => Caching old model for distillation...
2025-11-25 12:01:02,233 [trainer.py] => No NME accuracy.
2025-11-25 12:01:02,234 [trainer.py] => CNN: {'total': 62.12, '00-09': 78.21, '10-19': 70.86, '20-29': 78.4, '30-39': 68.48, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 56.76, '80-89': 52.83, '90-99': 36.73, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, '150-159': 47.06, '160-169': 46.0, '170-179': 37.5, 'old': 62.84, 'new': 37.5}
2025-11-25 12:01:02,234 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07, 64.6, 63.13, 62.12]
2025-11-25 12:01:02,234 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91, 86.19, 85.24, 84.1]

2025-11-25 12:01:02,234 [trainer.py] => Average Accuracy (CNN): 72.89499999999998 

2025-11-25 12:01:02,235 [trainer.py] => All params: 89220896
2025-11-25 12:01:02,235 [trainer.py] => Trainable params: 2525408
2025-11-25 12:01:02,236 [sema.py] => Learning on 180-190
2025-11-25 12:03:11,585 [sema.py] => func Task 18, Epoch 20/20 => Loss 0.234, Train_accy 95.95, Test_accy 60.14
2025-11-25 12:03:11,586 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:03:12,638 [sema.py] => Prototype replacement complete.
2025-11-25 12:03:17,791 [sema.py] => Caching old model for distillation...
2025-11-25 12:03:17,814 [trainer.py] => No NME accuracy.
2025-11-25 12:03:17,814 [trainer.py] => CNN: {'total': 62.05, '00-09': 78.21, '10-19': 70.86, '20-29': 78.4, '30-39': 68.48, '40-49': 64.22, '50-59': 67.79, '60-69': 70.31, '70-79': 56.76, '80-89': 50.94, '90-99': 36.73, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, '150-159': 47.06, '160-169': 46.0, '170-179': 37.5, '180-189': 62.0, 'old': 62.05, 'new': 62.0}
2025-11-25 12:03:17,814 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07, 64.6, 63.13, 62.12, 62.05]
2025-11-25 12:03:17,814 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91, 86.19, 85.24, 84.1, 83.96]

2025-11-25 12:03:17,814 [trainer.py] => Average Accuracy (CNN): 72.32421052631577 

2025-11-25 12:03:17,815 [trainer.py] => All params: 89220896
2025-11-25 12:03:17,816 [trainer.py] => Trainable params: 2525408
2025-11-25 12:03:17,816 [sema.py] => Learning on 190-200
2025-11-25 12:05:23,315 [sema.py] => func Task 19, Epoch 20/20 => Loss 0.197, Train_accy 97.44, Test_accy 59.84
2025-11-25 12:05:23,316 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:05:24,101 [sema.py] => Prototype replacement complete.
2025-11-25 12:05:29,282 [sema.py] => Caching old model for distillation...
2025-11-25 12:05:29,308 [trainer.py] => No NME accuracy.
2025-11-25 12:05:29,309 [trainer.py] => CNN: {'total': 61.95, '00-09': 78.21, '10-19': 70.86, '20-29': 78.4, '30-39': 68.48, '40-49': 64.22, '50-59': 67.79, '60-69': 69.53, '70-79': 56.76, '80-89': 50.94, '90-99': 36.73, '100-109': 27.03, '110-119': 35.29, '120-129': 35.71, '130-139': 37.04, '140-149': 50.98, '150-159': 47.06, '160-169': 46.0, '170-179': 37.5, '180-189': 60.0, '190-199': 62.96, 'old': 61.91, 'new': 62.96}
2025-11-25 12:05:29,309 [trainer.py] => CNN top1 curve: [89.1, 85.67, 82.3, 79.86, 78.51, 76.19, 74.45, 73.48, 73.19, 71.64, 70.17, 69.4, 67.02, 66.21, 65.07, 64.6, 63.13, 62.12, 62.05, 61.95]
2025-11-25 12:05:29,309 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.22, 97.46, 95.73, 94.19, 93.7, 93.35, 92.63, 91.45, 90.67, 89.28, 88.06, 86.91, 86.19, 85.24, 84.1, 83.96, 83.61]

2025-11-25 12:05:29,309 [trainer.py] => Average Accuracy (CNN): 71.80549999999998 

2025-11-25 12:08:53,964 [trainer.py] => config: exps/sema_ina.json
2025-11-25 12:08:53,964 [trainer.py] => eval: False
2025-11-25 12:08:53,965 [trainer.py] => prefix: reproduce
2025-11-25 12:08:53,965 [trainer.py] => dataset: imageneta
2025-11-25 12:08:53,965 [trainer.py] => imbalance_ratio: 0.5
2025-11-25 12:08:53,965 [trainer.py] => memory_size: 0
2025-11-25 12:08:53,965 [trainer.py] => memory_per_class: 0
2025-11-25 12:08:53,966 [trainer.py] => fixed_memory: False
2025-11-25 12:08:53,966 [trainer.py] => shuffle: False
2025-11-25 12:08:53,966 [trainer.py] => init_cls: 10
2025-11-25 12:08:53,966 [trainer.py] => increment: 10
2025-11-25 12:08:53,966 [trainer.py] => model_name: sema
2025-11-25 12:08:53,966 [trainer.py] => backbone_type: pretrained_vit_b16_224_adapter
2025-11-25 12:08:53,967 [trainer.py] => device: [device(type='cuda', index=0)]
2025-11-25 12:08:53,967 [trainer.py] => seed: 1993
2025-11-25 12:08:53,967 [trainer.py] => batch_size: 32
2025-11-25 12:08:53,967 [trainer.py] => weight_decay: 0.0005
2025-11-25 12:08:53,967 [trainer.py] => min_lr: 0
2025-11-25 12:08:53,967 [trainer.py] => ffn_adapter_type: adaptmlp
2025-11-25 12:08:53,968 [trainer.py] => ffn_num: 16
2025-11-25 12:08:53,968 [trainer.py] => optimizer: sgd
2025-11-25 12:08:53,968 [trainer.py] => vpt_type: shallow
2025-11-25 12:08:53,968 [trainer.py] => prompt_token_num: 5
2025-11-25 12:08:53,968 [trainer.py] => func_epoch: 20
2025-11-25 12:08:53,968 [trainer.py] => rd_epoch: 20
2025-11-25 12:08:53,969 [trainer.py] => init_lr: 0.005
2025-11-25 12:08:53,969 [trainer.py] => rd_lr: 0.01
2025-11-25 12:08:53,969 [trainer.py] => rd_dim: 128
2025-11-25 12:08:53,969 [trainer.py] => buffer_size: 500
2025-11-25 12:08:53,969 [trainer.py] => detect_batch_size: 128
2025-11-25 12:08:53,969 [trainer.py] => exp_threshold: 4
2025-11-25 12:08:53,970 [trainer.py] => exp_k_std: 5.0
2025-11-25 12:08:53,970 [trainer.py] => router_attn_dim: 128
2025-11-25 12:08:53,970 [trainer.py] => adapt_start_layer: 9
2025-11-25 12:08:53,970 [trainer.py] => adapt_end_layer: 11
2025-11-25 12:08:53,983 [data_manager.py] => [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
2025-11-25 12:08:53,994 [data_manager.py] => Inducing Random Class Imbalance (Ratio:0.5)
2025-11-25 12:08:53,999 [data_manager.py] => Imbalance Applied.
Max Samples: 86
Min Samples: 43
2025-11-25 12:08:55,152 [sema_block.py] => Adapter 0.0 added at block 0
2025-11-25 12:08:55,191 [sema_block.py] => Adapter 1.0 added at block 1
2025-11-25 12:08:55,222 [sema_block.py] => Adapter 2.0 added at block 2
2025-11-25 12:08:55,255 [sema_block.py] => Adapter 3.0 added at block 3
2025-11-25 12:08:55,285 [sema_block.py] => Adapter 4.0 added at block 4
2025-11-25 12:08:55,317 [sema_block.py] => Adapter 5.0 added at block 5
2025-11-25 12:08:55,351 [sema_block.py] => Adapter 6.0 added at block 6
2025-11-25 12:08:55,382 [sema_block.py] => Adapter 7.0 added at block 7
2025-11-25 12:08:55,413 [sema_block.py] => Adapter 8.0 added at block 8
2025-11-25 12:08:55,444 [sema_block.py] => Adapter 9.0 added at block 9
2025-11-25 12:08:55,480 [sema_block.py] => Adapter 10.0 added at block 10
2025-11-25 12:08:55,513 [sema_block.py] => Adapter 11.0 added at block 11
2025-11-25 12:08:56,232 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-25 12:08:58,212 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-11-25 12:08:58,414 [trainer.py] => All params: 89067096
2025-11-25 12:08:58,415 [trainer.py] => Trainable params: 3268440
2025-11-25 12:08:58,417 [sema.py] => Learning on 0-10
2025-11-25 12:10:01,980 [sema.py] => func Task 0, Epoch 20/20 => Loss 0.242, Train_accy 91.68, Test_accy 87.18
2025-11-25 12:11:08,154 [sema.py] => rd Task 0, Epoch 20/20 => Loss 1.304, Train_accy 0.00, Test_accy 87.18
2025-11-25 12:11:08,156 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:11:10,488 [sema.py] => Prototype replacement complete.
2025-11-25 12:11:11,212 [sema.py] => Caching old model for distillation...
2025-11-25 12:11:11,235 [trainer.py] => No NME accuracy.
2025-11-25 12:11:11,236 [trainer.py] => CNN: {'total': 88.46, '00-09': 88.46, 'old': 0, 'new': 88.46}
2025-11-25 12:11:11,236 [trainer.py] => CNN top1 curve: [88.46]
2025-11-25 12:11:11,236 [trainer.py] => CNN top5 curve: [99.36]

2025-11-25 12:11:11,236 [trainer.py] => Average Accuracy (CNN): 88.46 

2025-11-25 12:11:11,237 [trainer.py] => All params: 89220896
2025-11-25 12:11:11,237 [trainer.py] => Trainable params: 2525408
2025-11-25 12:11:11,238 [sema.py] => Learning on 10-20
2025-11-25 12:13:02,492 [sema.py] => func Task 1, Epoch 20/20 => Loss 0.330, Train_accy 93.69, Test_accy 67.10
2025-11-25 12:13:02,492 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:13:04,281 [sema.py] => Prototype replacement complete.
2025-11-25 12:13:05,467 [sema.py] => Caching old model for distillation...
2025-11-25 12:13:05,491 [trainer.py] => No NME accuracy.
2025-11-25 12:13:05,492 [trainer.py] => CNN: {'total': 85.99, '00-09': 86.54, '10-19': 85.43, 'old': 86.54, 'new': 85.43}
2025-11-25 12:13:05,492 [trainer.py] => CNN top1 curve: [88.46, 85.99]
2025-11-25 12:13:05,493 [trainer.py] => CNN top5 curve: [99.36, 99.67]

2025-11-25 12:13:05,493 [trainer.py] => Average Accuracy (CNN): 87.225 

2025-11-25 12:13:05,494 [trainer.py] => All params: 89220896
2025-11-25 12:13:05,494 [trainer.py] => Trainable params: 2525408
2025-11-25 12:13:05,494 [sema.py] => Learning on 20-30
2025-11-25 12:14:25,306 [sema.py] => func Task 2, Epoch 20/20 => Loss 0.272, Train_accy 93.59, Test_accy 68.02
2025-11-25 12:14:25,306 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:14:27,251 [sema.py] => Prototype replacement complete.
2025-11-25 12:14:28,892 [sema.py] => Caching old model for distillation...
2025-11-25 12:14:28,929 [trainer.py] => No NME accuracy.
2025-11-25 12:14:28,929 [trainer.py] => CNN: {'total': 82.09, '00-09': 82.05, '10-19': 81.46, '20-29': 82.72, 'old': 81.76, 'new': 82.72}
2025-11-25 12:14:28,930 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09]
2025-11-25 12:14:28,930 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51]

2025-11-25 12:14:28,930 [trainer.py] => Average Accuracy (CNN): 85.51333333333332 

2025-11-25 12:14:28,931 [trainer.py] => All params: 89220896
2025-11-25 12:14:28,931 [trainer.py] => Trainable params: 2525408
2025-11-25 12:14:28,931 [sema.py] => Learning on 30-40
2025-11-25 12:15:37,704 [sema.py] => func Task 3, Epoch 20/20 => Loss 0.238, Train_accy 97.26, Test_accy 73.44
2025-11-25 12:15:37,704 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:15:38,885 [sema.py] => Prototype replacement complete.
2025-11-25 12:15:42,120 [sema.py] => Caching old model for distillation...
2025-11-25 12:15:42,200 [trainer.py] => No NME accuracy.
2025-11-25 12:15:42,200 [trainer.py] => CNN: {'total': 79.68, '00-09': 79.49, '10-19': 79.47, '20-29': 79.63, '30-39': 80.43, 'old': 79.53, 'new': 80.43}
2025-11-25 12:15:42,200 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68]
2025-11-25 12:15:42,201 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04]

2025-11-25 12:15:42,201 [trainer.py] => Average Accuracy (CNN): 84.05499999999999 

2025-11-25 12:15:42,202 [trainer.py] => All params: 89220896
2025-11-25 12:15:42,202 [trainer.py] => Trainable params: 2525408
2025-11-25 12:15:42,203 [sema.py] => Learning on 40-50
2025-11-25 12:17:06,271 [sema.py] => func Task 4, Epoch 20/20 => Loss 0.325, Train_accy 93.88, Test_accy 71.19
2025-11-25 12:17:06,272 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:17:07,732 [sema.py] => Prototype replacement complete.
2025-11-25 12:17:10,123 [sema.py] => Caching old model for distillation...
2025-11-25 12:17:10,149 [trainer.py] => No NME accuracy.
2025-11-25 12:17:10,149 [trainer.py] => CNN: {'total': 78.66, '00-09': 78.21, '10-19': 78.15, '20-29': 79.63, '30-39': 79.35, '40-49': 77.98, 'old': 78.79, 'new': 77.98}
2025-11-25 12:17:10,149 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66]
2025-11-25 12:17:10,150 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16]

2025-11-25 12:17:10,150 [trainer.py] => Average Accuracy (CNN): 82.976 

2025-11-25 12:17:10,151 [trainer.py] => All params: 89220896
2025-11-25 12:17:10,151 [trainer.py] => Trainable params: 2525408
2025-11-25 12:17:10,152 [sema.py] => Learning on 50-60
2025-11-25 12:18:51,720 [sema.py] => func Task 5, Epoch 20/20 => Loss 0.448, Train_accy 89.85, Test_accy 67.64
2025-11-25 12:18:51,721 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:18:53,399 [sema.py] => Prototype replacement complete.
2025-11-25 12:18:56,238 [sema.py] => Caching old model for distillation...
2025-11-25 12:18:56,265 [trainer.py] => No NME accuracy.
2025-11-25 12:18:56,266 [trainer.py] => CNN: {'total': 75.46, '00-09': 78.21, '10-19': 75.5, '20-29': 79.01, '30-39': 79.35, '40-49': 76.15, '50-59': 65.77, 'old': 77.61, 'new': 65.77}
2025-11-25 12:18:56,266 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46]
2025-11-25 12:18:56,267 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36]

2025-11-25 12:18:56,267 [trainer.py] => Average Accuracy (CNN): 81.72333333333333 

2025-11-25 12:18:56,268 [trainer.py] => All params: 89220896
2025-11-25 12:18:56,268 [trainer.py] => Trainable params: 2525408
2025-11-25 12:18:56,269 [sema.py] => Learning on 60-70
2025-11-25 12:20:41,526 [sema.py] => func Task 6, Epoch 20/20 => Loss 0.309, Train_accy 92.50, Test_accy 66.10
2025-11-25 12:20:41,526 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:20:44,317 [sema.py] => Prototype replacement complete.
2025-11-25 12:20:47,428 [sema.py] => Caching old model for distillation...
2025-11-25 12:20:47,447 [trainer.py] => No NME accuracy.
2025-11-25 12:20:47,448 [trainer.py] => CNN: {'total': 72.97, '00-09': 78.21, '10-19': 74.83, '20-29': 79.01, '30-39': 78.26, '40-49': 70.64, '50-59': 65.1, '60-69': 64.06, 'old': 74.36, 'new': 64.06}
2025-11-25 12:20:47,448 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97]
2025-11-25 12:20:47,448 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3]

2025-11-25 12:20:47,448 [trainer.py] => Average Accuracy (CNN): 80.47285714285714 

2025-11-25 12:20:47,449 [trainer.py] => All params: 89220896
2025-11-25 12:20:47,449 [trainer.py] => Trainable params: 2525408
2025-11-25 12:20:47,450 [sema.py] => Learning on 70-80
2025-11-25 12:22:07,706 [sema.py] => func Task 7, Epoch 20/20 => Loss 0.278, Train_accy 95.89, Test_accy 70.63
2025-11-25 12:22:07,707 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:22:08,350 [sema.py] => Prototype replacement complete.
2025-11-25 12:22:11,494 [sema.py] => Caching old model for distillation...
2025-11-25 12:22:11,516 [trainer.py] => No NME accuracy.
2025-11-25 12:22:11,516 [trainer.py] => CNN: {'total': 72.26, '00-09': 77.56, '10-19': 74.17, '20-29': 79.01, '30-39': 77.17, '40-49': 68.81, '50-59': 65.1, '60-69': 64.06, '70-79': 67.57, 'old': 72.44, 'new': 67.57}
2025-11-25 12:22:11,517 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26]
2025-11-25 12:22:11,517 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39]

2025-11-25 12:22:11,518 [trainer.py] => Average Accuracy (CNN): 79.44624999999999 

2025-11-25 12:22:11,518 [trainer.py] => All params: 89220896
2025-11-25 12:22:11,519 [trainer.py] => Trainable params: 2525408
2025-11-25 12:22:11,519 [sema.py] => Learning on 80-90
2025-11-25 12:23:39,761 [sema.py] => func Task 8, Epoch 20/20 => Loss 0.306, Train_accy 93.81, Test_accy 70.20
2025-11-25 12:23:39,762 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:23:40,587 [sema.py] => Prototype replacement complete.
2025-11-25 12:23:43,801 [sema.py] => Caching old model for distillation...
2025-11-25 12:23:43,821 [trainer.py] => No NME accuracy.
2025-11-25 12:23:43,821 [trainer.py] => CNN: {'total': 72.03, '00-09': 77.56, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 68.81, '50-59': 64.43, '60-69': 64.06, '70-79': 64.86, '80-89': 81.13, 'old': 71.54, 'new': 81.13}
2025-11-25 12:23:43,821 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03]
2025-11-25 12:23:43,822 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77]

2025-11-25 12:23:43,822 [trainer.py] => Average Accuracy (CNN): 78.6222222222222 

2025-11-25 12:23:43,822 [trainer.py] => All params: 89220896
2025-11-25 12:23:43,823 [trainer.py] => Trainable params: 2525408
2025-11-25 12:23:43,823 [sema.py] => Learning on 90-100
2025-11-25 12:25:16,496 [sema.py] => func Task 9, Epoch 20/20 => Loss 0.289, Train_accy 94.44, Test_accy 68.97
2025-11-25 12:25:16,496 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:25:17,376 [sema.py] => Prototype replacement complete.
2025-11-25 12:25:20,799 [sema.py] => Caching old model for distillation...
2025-11-25 12:25:20,870 [trainer.py] => No NME accuracy.
2025-11-25 12:25:20,871 [trainer.py] => CNN: {'total': 70.72, '00-09': 77.56, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 66.97, '50-59': 63.09, '60-69': 64.06, '70-79': 64.86, '80-89': 73.58, '90-99': 59.18, 'old': 71.26, 'new': 59.18}
2025-11-25 12:25:20,872 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72]
2025-11-25 12:25:20,873 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9]

2025-11-25 12:25:20,873 [trainer.py] => Average Accuracy (CNN): 77.832 

2025-11-25 12:25:20,874 [trainer.py] => All params: 89220896
2025-11-25 12:25:20,875 [trainer.py] => Trainable params: 2525408
2025-11-25 12:25:20,875 [sema.py] => Learning on 100-110
2025-11-25 12:26:48,062 [sema.py] => func Task 10, Epoch 20/20 => Loss 0.267, Train_accy 96.27, Test_accy 68.12
2025-11-25 12:26:48,063 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:26:48,706 [sema.py] => Prototype replacement complete.
2025-11-25 12:26:52,307 [sema.py] => Caching old model for distillation...
2025-11-25 12:26:52,328 [trainer.py] => No NME accuracy.
2025-11-25 12:26:52,329 [trainer.py] => CNN: {'total': 69.19, '00-09': 77.56, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 66.97, '50-59': 63.09, '60-69': 64.06, '70-79': 64.86, '80-89': 66.04, '90-99': 53.06, '100-109': 43.24, 'old': 70.07, 'new': 43.24}
2025-11-25 12:26:52,329 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19]
2025-11-25 12:26:52,330 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1]

2025-11-25 12:26:52,330 [trainer.py] => Average Accuracy (CNN): 77.04636363636364 

2025-11-25 12:26:52,330 [trainer.py] => All params: 89220896
2025-11-25 12:26:52,331 [trainer.py] => Trainable params: 2525408
2025-11-25 12:26:52,331 [sema.py] => Learning on 110-120
2025-11-25 12:28:22,703 [sema.py] => func Task 11, Epoch 20/20 => Loss 0.182, Train_accy 99.21, Test_accy 66.81
2025-11-25 12:28:22,703 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:28:23,262 [sema.py] => Prototype replacement complete.
2025-11-25 12:28:26,843 [sema.py] => Caching old model for distillation...
2025-11-25 12:28:26,862 [trainer.py] => No NME accuracy.
2025-11-25 12:28:26,862 [trainer.py] => CNN: {'total': 67.85, '00-09': 75.64, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 66.97, '50-59': 63.09, '60-69': 63.28, '70-79': 62.16, '80-89': 62.26, '90-99': 53.06, '100-109': 40.54, '110-119': 47.06, 'old': 68.48, 'new': 47.06}
2025-11-25 12:28:26,863 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85]
2025-11-25 12:28:26,863 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41]

2025-11-25 12:28:26,863 [trainer.py] => Average Accuracy (CNN): 76.28 

2025-11-25 12:28:26,863 [trainer.py] => All params: 89220896
2025-11-25 12:28:26,864 [trainer.py] => Trainable params: 2525408
2025-11-25 12:28:26,864 [sema.py] => Learning on 120-130
2025-11-25 12:30:07,751 [sema.py] => func Task 12, Epoch 20/20 => Loss 0.299, Train_accy 94.89, Test_accy 64.39
2025-11-25 12:30:07,752 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:30:08,671 [sema.py] => Prototype replacement complete.
2025-11-25 12:30:12,484 [sema.py] => Caching old model for distillation...
2025-11-25 12:30:12,507 [trainer.py] => No NME accuracy.
2025-11-25 12:30:12,508 [trainer.py] => CNN: {'total': 66.12, '00-09': 75.64, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 66.06, '50-59': 63.09, '60-69': 63.28, '70-79': 62.16, '80-89': 60.38, '90-99': 51.02, '100-109': 35.14, '110-119': 44.12, '120-129': 41.07, 'old': 67.33, 'new': 41.07}
2025-11-25 12:30:12,508 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12]
2025-11-25 12:30:12,508 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79]

2025-11-25 12:30:12,508 [trainer.py] => Average Accuracy (CNN): 75.49846153846154 

2025-11-25 12:30:12,509 [trainer.py] => All params: 89220896
2025-11-25 12:30:12,509 [trainer.py] => Trainable params: 2525408
2025-11-25 12:30:12,510 [sema.py] => Learning on 130-140
2025-11-25 12:31:46,093 [sema.py] => func Task 13, Epoch 20/20 => Loss 0.202, Train_accy 97.35, Test_accy 64.35
2025-11-25 12:31:46,094 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:31:46,645 [sema.py] => Prototype replacement complete.
2025-11-25 12:31:50,522 [sema.py] => Caching old model for distillation...
2025-11-25 12:31:50,543 [trainer.py] => No NME accuracy.
2025-11-25 12:31:50,544 [trainer.py] => CNN: {'total': 65.32, '00-09': 75.64, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 62.16, '80-89': 60.38, '90-99': 44.9, '100-109': 35.14, '110-119': 44.12, '120-129': 41.07, '130-139': 44.44, 'old': 65.79, 'new': 44.44}
2025-11-25 12:31:50,544 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32]
2025-11-25 12:31:50,544 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15]

2025-11-25 12:31:50,544 [trainer.py] => Average Accuracy (CNN): 74.77142857142857 

2025-11-25 12:31:50,545 [trainer.py] => All params: 89220896
2025-11-25 12:31:50,545 [trainer.py] => Trainable params: 2525408
2025-11-25 12:31:50,546 [sema.py] => Learning on 140-150
2025-11-25 12:33:32,132 [sema.py] => func Task 14, Epoch 20/20 => Loss 0.190, Train_accy 97.62, Test_accy 62.35
2025-11-25 12:33:32,133 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:33:32,835 [sema.py] => Prototype replacement complete.
2025-11-25 12:33:36,767 [sema.py] => Caching old model for distillation...
2025-11-25 12:33:36,786 [trainer.py] => No NME accuracy.
2025-11-25 12:33:36,787 [trainer.py] => CNN: {'total': 63.83, '00-09': 75.64, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 62.16, '80-89': 56.6, '90-99': 42.86, '100-109': 32.43, '110-119': 38.24, '120-129': 37.5, '130-139': 44.44, '140-149': 43.14, 'old': 64.68, 'new': 43.14}
2025-11-25 12:33:36,787 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83]
2025-11-25 12:33:36,788 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3]

2025-11-25 12:33:36,788 [trainer.py] => Average Accuracy (CNN): 74.04199999999999 

2025-11-25 12:33:36,788 [trainer.py] => All params: 89220896
2025-11-25 12:33:36,789 [trainer.py] => Trainable params: 2525408
2025-11-25 12:33:36,789 [sema.py] => Learning on 150-160
2025-11-25 12:35:18,491 [sema.py] => func Task 15, Epoch 20/20 => Loss 0.168, Train_accy 100.00, Test_accy 61.89
2025-11-25 12:35:18,491 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:35:19,134 [sema.py] => Prototype replacement complete.
2025-11-25 12:35:24,739 [sema.py] => Caching old model for distillation...
2025-11-25 12:35:24,759 [trainer.py] => No NME accuracy.
2025-11-25 12:35:24,759 [trainer.py] => CNN: {'total': 63.02, '00-09': 75.64, '10-19': 74.17, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 62.16, '80-89': 52.83, '90-99': 40.82, '100-109': 32.43, '110-119': 38.24, '120-129': 37.5, '130-139': 44.44, '140-149': 41.18, '150-159': 44.12, 'old': 63.52, 'new': 44.12}
2025-11-25 12:35:24,759 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83, 63.02]
2025-11-25 12:35:24,759 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3, 86.42]

2025-11-25 12:35:24,759 [trainer.py] => Average Accuracy (CNN): 73.35312499999999 

2025-11-25 12:35:24,760 [trainer.py] => All params: 89220896
2025-11-25 12:35:24,760 [trainer.py] => Trainable params: 2525408
2025-11-25 12:35:24,761 [sema.py] => Learning on 160-170
2025-11-25 12:37:13,458 [sema.py] => func Task 16, Epoch 20/20 => Loss 0.224, Train_accy 98.12, Test_accy 60.36
2025-11-25 12:37:13,459 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:37:14,316 [sema.py] => Prototype replacement complete.
2025-11-25 12:37:18,535 [sema.py] => Caching old model for distillation...
2025-11-25 12:37:18,603 [trainer.py] => No NME accuracy.
2025-11-25 12:37:18,604 [trainer.py] => CNN: {'total': 61.96, '00-09': 75.64, '10-19': 73.51, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 59.46, '80-89': 52.83, '90-99': 40.82, '100-109': 27.03, '110-119': 35.29, '120-129': 37.5, '130-139': 40.74, '140-149': 41.18, '150-159': 44.12, '160-169': 46.0, 'old': 62.57, 'new': 46.0}
2025-11-25 12:37:18,605 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83, 63.02, 61.96]
2025-11-25 12:37:18,605 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3, 86.42, 84.87]

2025-11-25 12:37:18,606 [trainer.py] => Average Accuracy (CNN): 72.68294117647058 

2025-11-25 12:37:18,606 [trainer.py] => All params: 89220896
2025-11-25 12:37:18,607 [trainer.py] => Trainable params: 2525408
2025-11-25 12:37:18,608 [sema.py] => Learning on 170-180
2025-11-25 12:39:07,886 [sema.py] => func Task 17, Epoch 20/20 => Loss 0.328, Train_accy 95.14, Test_accy 59.86
2025-11-25 12:39:07,887 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:39:08,671 [sema.py] => Prototype replacement complete.
2025-11-25 12:39:13,114 [sema.py] => Caching old model for distillation...
2025-11-25 12:39:13,138 [trainer.py] => No NME accuracy.
2025-11-25 12:39:13,138 [trainer.py] => CNN: {'total': 61.06, '00-09': 75.64, '10-19': 73.51, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 59.46, '80-89': 52.83, '90-99': 40.82, '100-109': 27.03, '110-119': 35.29, '120-129': 37.5, '130-139': 40.74, '140-149': 41.18, '150-159': 41.18, '160-169': 46.0, '170-179': 32.5, 'old': 61.89, 'new': 32.5}
2025-11-25 12:39:13,138 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83, 63.02, 61.96, 61.06]
2025-11-25 12:39:13,139 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3, 86.42, 84.87, 83.53]

2025-11-25 12:39:13,139 [trainer.py] => Average Accuracy (CNN): 72.03722222222221 

2025-11-25 12:39:13,140 [trainer.py] => All params: 89220896
2025-11-25 12:39:13,140 [trainer.py] => Trainable params: 2525408
2025-11-25 12:39:13,141 [sema.py] => Learning on 180-190
2025-11-25 12:41:06,459 [sema.py] => func Task 18, Epoch 20/20 => Loss 0.239, Train_accy 94.42, Test_accy 58.98
2025-11-25 12:41:06,460 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:41:07,284 [sema.py] => Prototype replacement complete.
2025-11-25 12:41:11,998 [sema.py] => Caching old model for distillation...
2025-11-25 12:41:12,025 [trainer.py] => No NME accuracy.
2025-11-25 12:41:12,026 [trainer.py] => CNN: {'total': 61.16, '00-09': 75.64, '10-19': 73.51, '20-29': 78.4, '30-39': 72.83, '40-49': 65.14, '50-59': 63.09, '60-69': 63.28, '70-79': 59.46, '80-89': 52.83, '90-99': 40.82, '100-109': 27.03, '110-119': 35.29, '120-129': 37.5, '130-139': 40.74, '140-149': 41.18, '150-159': 41.18, '160-169': 46.0, '170-179': 32.5, '180-189': 64.0, 'old': 61.06, 'new': 64.0}
2025-11-25 12:41:12,026 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83, 63.02, 61.96, 61.06, 61.16]
2025-11-25 12:41:12,026 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3, 86.42, 84.87, 83.53, 83.48]

2025-11-25 12:41:12,026 [trainer.py] => Average Accuracy (CNN): 71.46473684210525 

2025-11-25 12:41:12,027 [trainer.py] => All params: 89220896
2025-11-25 12:41:12,028 [trainer.py] => Trainable params: 2525408
2025-11-25 12:41:12,028 [sema.py] => Learning on 190-200
2025-11-25 12:43:06,999 [sema.py] => func Task 19, Epoch 20/20 => Loss 0.242, Train_accy 98.08, Test_accy 59.12
2025-11-25 12:43:07,000 [sema.py] => Computing class prototypes (NCM) for new classes...
2025-11-25 12:43:07,696 [sema.py] => Prototype replacement complete.
2025-11-25 12:43:12,511 [sema.py] => Caching old model for distillation...
2025-11-25 12:43:12,530 [trainer.py] => No NME accuracy.
2025-11-25 12:43:12,531 [trainer.py] => CNN: {'total': 60.7, '00-09': 75.64, '10-19': 73.51, '20-29': 77.78, '30-39': 72.83, '40-49': 65.14, '50-59': 62.42, '60-69': 63.28, '70-79': 59.46, '80-89': 49.06, '90-99': 40.82, '100-109': 27.03, '110-119': 35.29, '120-129': 37.5, '130-139': 40.74, '140-149': 41.18, '150-159': 41.18, '160-169': 46.0, '170-179': 30.0, '180-189': 62.0, '190-199': 59.26, 'old': 60.75, 'new': 59.26}
2025-11-25 12:43:12,531 [trainer.py] => CNN top1 curve: [88.46, 85.99, 82.09, 79.68, 78.66, 75.46, 72.97, 72.26, 72.03, 70.72, 69.19, 67.85, 66.12, 65.32, 63.83, 63.02, 61.96, 61.06, 61.16, 60.7]
2025-11-25 12:43:12,531 [trainer.py] => CNN top5 curve: [99.36, 99.67, 98.51, 98.04, 97.16, 95.36, 94.3, 93.39, 92.77, 91.9, 91.1, 90.41, 88.79, 88.15, 87.3, 86.42, 84.87, 83.53, 83.48, 83.02]

2025-11-25 12:43:12,531 [trainer.py] => Average Accuracy (CNN): 70.9265 

